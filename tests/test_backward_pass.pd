#N canvas 8 70 1383 951 16;
#X msg 17 12 bang;
#X obj 17 40 t b b;
#X obj 54 73 f \$0;
#X obj 54 101 v \$0_ns;
#X obj 113 195 v \$0_m;
#X obj 209 196 v \$0_nx;
#X msg 306 167 1;
#X obj 306 195 v \$0_ny;
#X msg 402 167 1;
#X obj 402 195 v \$0_nL-0;
#X obj 498 195 v \$0_nL-1;
#X obj 595 195 v \$0_nL-2;
#X obj 691 195 v \$0_nL-3;
#X obj 788 195 v \$0_nL-4;
#X obj 884 195 v \$0_nL-5;
#X obj 980 195 v \$0_nL-6;
#N canvas 0 66 3440 1340 arrays 0;
#X obj 9 10 inlet;
#X obj 63 10 s \$0_size_arrays;
#X msg 425 11 const 0;
#X msg 27 190 resize \$1;
#X obj 27 158 *;
#X obj 27 92 t b b;
#X obj 27 64 r \$0_size_arrays;
#X msg 377 158 resize \$1;
#X obj 377 64 r \$0_size_arrays;
#X msg 27 517 resize \$1;
#X obj 27 484 *;
#X obj 27 418 t b b;
#X obj 27 390 r \$0_size_arrays;
#X obj 117 451 v \$0_m;
#X text 29 35 // output layer;
#X obj 27 125 v \$0_nL-0;
#X obj 117 125 v \$0_nL-1;
#X obj 27 251 array define \$0_WL-0;
#X obj 67 284 array define \$0_dWL-0;
#X obj 377 125 v \$0_nL-0;
#X obj 377 251 array define \$0_bL-0;
#X obj 417 284 array define \$0_dbL-0;
#X obj 27 451 v \$0_nL-0;
#X obj 27 583 array define \$0_ZL-0;
#X obj 156 616 array define \$0_dZL-0;
#X obj 206 583 array define \$0_AL-0;
#X obj 337 616 array define \$0_dAL-0;
#X obj 27 550 t a a a a, f 34;
#X obj 107 317 array define \$0_VdWL-0;
#X obj 457 317 array define \$0_VdbL-0;
#X obj 495 11 s \$0_const_arrays;
#X obj 232 64 r \$0_const_arrays;
#X obj 202 390 r \$0_const_arrays;
#X msg 657 190 resize \$1;
#X obj 657 158 *;
#X obj 657 92 t b b;
#X obj 657 64 r \$0_size_arrays;
#X msg 1007 158 resize \$1;
#X obj 1007 64 r \$0_size_arrays;
#X msg 657 517 resize \$1;
#X obj 657 484 *;
#X obj 657 418 t b b;
#X obj 657 390 r \$0_size_arrays;
#X obj 747 451 v \$0_m;
#X obj 657 550 t a a a a, f 34;
#X obj 862 64 r \$0_const_arrays;
#X obj 832 390 r \$0_const_arrays;
#X obj 657 125 v \$0_nL-1;
#X obj 747 125 v \$0_nL-2;
#X obj 1007 125 v \$0_nL-1;
#X obj 657 251 array define \$0_WL-1;
#X obj 697 284 array define \$0_dWL-1;
#X obj 737 317 array define \$0_VdWL-1;
#X obj 1007 251 array define \$0_bL-1;
#X obj 1047 284 array define \$0_dbL-1;
#X obj 1087 317 array define \$0_VdbL-1;
#X obj 657 583 array define \$0_ZL-1;
#X obj 836 583 array define \$0_AL-1;
#X obj 786 616 array define \$0_dZL-1;
#X obj 967 616 array define \$0_dAL-1;
#X text 667 32 // L-1;
#X obj 657 451 v \$0_nL-1;
#X msg 1287 190 resize \$1;
#X obj 1287 158 *;
#X obj 1287 92 t b b;
#X obj 1287 64 r \$0_size_arrays;
#X msg 1637 158 resize \$1;
#X obj 1637 64 r \$0_size_arrays;
#X msg 1287 517 resize \$1;
#X obj 1287 484 *;
#X obj 1287 418 t b b;
#X obj 1287 390 r \$0_size_arrays;
#X obj 1377 451 v \$0_m;
#X obj 1287 550 t a a a a, f 34;
#X obj 1492 64 r \$0_const_arrays;
#X obj 1462 390 r \$0_const_arrays;
#X text 1291 35 // L-2;
#X obj 1287 125 v \$0_nL-2;
#X obj 1637 125 v \$0_nL-2;
#X obj 1287 251 array define \$0_WL-2;
#X obj 1327 284 array define \$0_dWL-2;
#X obj 1367 317 array define \$0_VdWL-2;
#X obj 1637 251 array define \$0_bL-2;
#X obj 1675 284 array define \$0_dbL-2;
#X obj 1717 317 array define \$0_VdbL-2;
#X obj 1287 451 v \$0_nL-2;
#X obj 1287 583 array define \$0_ZL-2;
#X obj 1466 583 array define \$0_AL-2;
#X obj 1416 616 array define \$0_dZL-2;
#X obj 1597 616 array define \$0_dAL-2;
#X msg 1927 190 resize \$1;
#X obj 1927 158 *;
#X obj 1927 92 t b b;
#X obj 1927 64 r \$0_size_arrays;
#X msg 2277 158 resize \$1;
#X obj 2277 64 r \$0_size_arrays;
#X msg 1927 517 resize \$1;
#X obj 1927 484 *;
#X obj 1927 418 t b b;
#X obj 1927 390 r \$0_size_arrays;
#X obj 2017 451 v \$0_m;
#X obj 1927 550 t a a a a, f 34;
#X obj 2132 64 r \$0_const_arrays;
#X obj 2102 390 r \$0_const_arrays;
#X obj 275 11 inlet cont_arrays;
#X text 1928 38 // L-3;
#X obj 1927 125 v \$0_nL-3;
#X obj 2277 125 v \$0_nL-3;
#X obj 1927 251 array define \$0_WL-3;
#X obj 1967 284 array define \$0_dWL-3;
#X obj 2007 317 array define \$0_VdWL-3;
#X obj 2277 251 array define \$0_bL-3;
#X obj 2318 284 array define \$0_dbL-3;
#X obj 2357 317 array define \$0_VdbL-3;
#X obj 1927 451 v \$0_nL-3;
#X obj 1927 583 array define \$0_ZL-3;
#X obj 2106 583 array define \$0_AL-3;
#X obj 2056 616 array define \$0_dZL-3;
#X obj 2237 616 array define \$0_dAL-3;
#X obj 202 418 t a a a a;
#X obj 832 418 t a a a a;
#X obj 1462 418 t a a a a;
#X obj 2102 418 t a a a a;
#X obj 1377 125 v \$0_nL-3;
#X obj 2017 125 v \$0_nL-4;
#X msg 2557 190 resize \$1;
#X obj 2557 158 *;
#X obj 2557 92 t b b;
#X obj 2557 64 r \$0_size_arrays;
#X msg 2907 158 resize \$1;
#X obj 2907 64 r \$0_size_arrays;
#X msg 2557 517 resize \$1;
#X obj 2557 484 *;
#X obj 2557 418 t b b;
#X obj 2557 390 r \$0_size_arrays;
#X obj 2647 451 v \$0_m;
#X obj 2557 550 t a a a a, f 34;
#X obj 2762 64 r \$0_const_arrays;
#X obj 2732 390 r \$0_const_arrays;
#X obj 2732 418 t a a a a;
#X text 2558 38 // L-4;
#X obj 2557 125 v \$0_nL-4;
#X obj 2647 125 v \$0_nL-5;
#X obj 2907 125 v \$0_nL-4;
#X obj 2557 251 array define \$0_WL-4;
#X obj 2597 284 array define \$0_dWL-4;
#X obj 2637 317 array define \$0_VdWL-4;
#X obj 2907 251 array define \$0_bL-4;
#X obj 2948 284 array define \$0_dbL-4;
#X obj 2987 317 array define \$0_VdbL-4;
#X obj 2557 451 v \$0_nL-4;
#X obj 2557 583 array define \$0_ZL-4;
#X obj 2736 583 array define \$0_AL-4;
#X obj 2686 616 array define \$0_dZL-4;
#X obj 2867 616 array define \$0_dAL-4;
#X msg 27 820 resize \$1;
#X obj 27 788 *;
#X obj 27 722 t b b;
#X obj 27 694 r \$0_size_arrays;
#X msg 377 788 resize \$1;
#X obj 377 694 r \$0_size_arrays;
#X msg 27 1167 resize \$1;
#X obj 27 1134 *;
#X obj 27 1068 t b b;
#X obj 27 1040 r \$0_size_arrays;
#X obj 117 1101 v \$0_m;
#X obj 27 1200 t a a a a, f 34;
#X obj 232 694 r \$0_const_arrays;
#X obj 202 1040 r \$0_const_arrays;
#X obj 202 1068 t a a a a;
#X text 28 668 // L-5;
#X obj 27 755 v \$0_nL-5;
#X obj 377 755 v \$0_nL-5;
#X obj 27 881 array define \$0_WL-5;
#X obj 67 914 array define \$0_dWL-5;
#X obj 107 947 array define \$0_VdWL-5;
#X obj 377 881 array define \$0_bL-5;
#X obj 418 914 array define \$0_dbL-5;
#X obj 457 947 array define \$0_VdbL-5;
#X obj 27 1101 v \$0_nL-5;
#X obj 27 1233 array define \$0_ZL-5;
#X obj 206 1233 array define \$0_AL-5;
#X obj 156 1266 array define \$0_dZL-5;
#X obj 337 1266 array define \$0_dAL-5;
#X obj 137 347 array define \$0_SdWL-0;
#X obj 487 347 array define \$0_SdbL-0;
#X obj 27 218 t a a a a;
#X obj 377 186 t a a a a;
#X obj 232 92 t a a a a a a a a;
#X obj 767 347 array define \$0_SdWL-1;
#X obj 1117 347 array define \$0_SdbL-1;
#X obj 657 218 t a a a a;
#X obj 1007 186 t a a a a;
#X obj 862 91 t a a a a a a a a;
#X obj 1397 347 array define \$0_SdWL-2;
#X obj 1747 347 array define \$0_SdbL-2;
#X obj 1287 218 t a a a a;
#X obj 1637 186 t a a a a;
#X obj 1492 92 t a a a a a a a a;
#X obj 2037 347 array define \$0_SdWL-3;
#X obj 2387 347 array define \$0_SdbL-3;
#X obj 1927 218 t a a a a;
#X obj 2277 186 t a a a a;
#X obj 2132 92 t a a a a a a a a;
#X obj 2667 347 array define \$0_SdWL-4;
#X obj 3017 347 array define \$0_SdbL-4;
#X obj 2557 218 t a a a a;
#X obj 2907 186 t a a a a;
#X obj 2762 92 t a a a a a a a a;
#X obj 117 755 v \$0_nx;
#X obj 137 977 array define \$0_SdWL-5;
#X obj 487 977 array define \$0_SdbL-5;
#X obj 27 848 t a a a a;
#X obj 377 816 t a a a a;
#X obj 232 722 t a a a a a a a a;
#X text 107 665 // *** CURRENT OUTPUT LAYER ***;
#X msg 687 820 resize \$1;
#X obj 687 788 *;
#X obj 687 722 t b b;
#X obj 687 694 r \$0_size_arrays;
#X msg 1037 788 resize \$1;
#X obj 1037 694 r \$0_size_arrays;
#X msg 687 1167 resize \$1;
#X obj 687 1134 *;
#X obj 687 1068 t b b;
#X obj 687 1040 r \$0_size_arrays;
#X obj 777 1101 v \$0_m;
#X obj 687 1200 t a a a a, f 34;
#X obj 892 694 r \$0_const_arrays;
#X obj 862 1040 r \$0_const_arrays;
#X obj 862 1068 t a a a a;
#X obj 687 848 t a a a a;
#X obj 1037 816 t a a a a;
#X obj 892 722 t a a a a a a a a;
#X text 688 668 // L-6;
#X obj 687 755 v \$0_nL-6;
#X obj 777 755 v \$0_nL-7;
#X obj 1037 755 v \$0_nL-6;
#X obj 687 881 array define \$0_WL-6;
#X obj 727 914 array define \$0_dWL-6;
#X obj 767 947 array define \$0_VdWL-6;
#X obj 797 977 array define \$0_SdWL-6;
#X obj 1037 881 array define \$0_bL-6;
#X obj 1078 914 array define \$0_dbL-6;
#X obj 1117 947 array define \$0_VdbL-6;
#X obj 1147 977 array define \$0_SdbL-6;
#X obj 687 1101 v \$0_nL-6;
#X obj 687 1233 array define \$0_ZL-6;
#X obj 866 1233 array define \$0_AL-6;
#X obj 816 1266 array define \$0_dZL-6;
#X obj 997 1266 array define \$0_dAL-6;
#X msg 1357 820 resize \$1;
#X obj 1357 788 *;
#X obj 1357 722 t b b;
#X obj 1357 694 r \$0_size_arrays;
#X msg 1707 788 resize \$1;
#X obj 1707 694 r \$0_size_arrays;
#X msg 1357 1167 resize \$1;
#X obj 1357 1134 *;
#X obj 1357 1068 t b b;
#X obj 1357 1040 r \$0_size_arrays;
#X obj 1447 1101 v \$0_m;
#X obj 1357 1200 t a a a a, f 34;
#X obj 1562 694 r \$0_const_arrays;
#X obj 1532 1040 r \$0_const_arrays;
#X obj 1532 1068 t a a a a;
#X obj 1357 848 t a a a a;
#X obj 1707 816 t a a a a;
#X obj 1562 722 t a a a a a a a a;
#X text 1358 668 // L-7;
#X obj 1357 755 v \$0_nL-7;
#X obj 1447 755 v \$0_nL-8;
#X obj 1707 755 v \$0_nL-7;
#X obj 1357 881 array define \$0_WL-7;
#X obj 1397 914 array define \$0_dWL-7;
#X obj 1437 947 array define \$0_VdWL-7;
#X obj 1467 977 array define \$0_SdWL-7;
#X obj 1707 881 array define \$0_bL-7;
#X obj 1748 914 array define \$0_dbL-7;
#X obj 1787 947 array define \$0_VdbL-7;
#X obj 1817 977 array define \$0_SdbL-7;
#X obj 1357 1101 v \$0_nL-7;
#X obj 1357 1233 array define \$0_ZL-7;
#X obj 1536 1233 array define \$0_AL-7;
#X obj 1486 1266 array define \$0_dZL-7;
#X obj 1667 1266 array define \$0_dAL-7;
#N canvas 609 55 908 890 l-8 0;
#X msg 298 182 resize \$1;
#X obj 298 150 *;
#X obj 298 84 t b b;
#X obj 298 56 r \$0_size_arrays;
#X msg 648 150 resize \$1;
#X obj 648 56 r \$0_size_arrays;
#X msg 298 609 resize \$1;
#X obj 298 576 *;
#X obj 298 510 t b b;
#X obj 298 482 r \$0_size_arrays;
#X obj 388 543 v \$0_m;
#X obj 298 642 t a a a a, f 10;
#X obj 53 56 r \$0_const_arrays;
#X obj 53 482 r \$0_const_arrays;
#X obj 53 510 t a a a a, f 10;
#X obj 298 210 t a a a a, f 10;
#X obj 648 178 t a a a a;
#X obj 53 84 t a a a a a a a a;
#X text 299 30 // L-8;
#X obj 298 117 v \$0_nL-8;
#X obj 388 117 v \$0_nL-9;
#X obj 648 117 v \$0_nL-8;
#X obj 298 253 array define \$0_WL-8;
#X obj 298 296 array define \$0_dWL-8;
#X obj 298 339 array define \$0_VdWL-8;
#X obj 298 379 array define \$0_SdWL-8;
#X obj 648 253 array define \$0_bL-8;
#X obj 649 296 array define \$0_dbL-8;
#X obj 648 339 array define \$0_VdbL-8;
#X obj 648 379 array define \$0_SdbL-8;
#X obj 298 543 v \$0_nL-8;
#X obj 298 685 array define \$0_ZL-8;
#X obj 297 728 array define \$0_dZL-8;
#X obj 295 771 array define \$0_AL-8;
#X obj 296 814 array define \$0_dAL-8;
#X connect 0 0 15 0;
#X connect 1 0 0 0;
#X connect 2 0 19 0;
#X connect 2 1 20 0;
#X connect 3 0 2 0;
#X connect 4 0 16 0;
#X connect 5 0 21 0;
#X connect 6 0 11 0;
#X connect 7 0 6 0;
#X connect 8 0 30 0;
#X connect 8 1 10 0;
#X connect 9 0 8 0;
#X connect 10 0 7 1;
#X connect 11 0 31 0;
#X connect 11 1 32 0;
#X connect 11 2 33 0;
#X connect 11 3 34 0;
#X connect 12 0 17 0;
#X connect 13 0 14 0;
#X connect 14 0 34 0;
#X connect 14 1 33 0;
#X connect 14 2 32 0;
#X connect 14 3 31 0;
#X connect 15 0 22 0;
#X connect 15 1 23 0;
#X connect 15 2 24 0;
#X connect 15 3 25 0;
#X connect 16 0 26 0;
#X connect 16 1 27 0;
#X connect 16 2 28 0;
#X connect 16 3 29 0;
#X connect 17 0 25 0;
#X connect 17 1 24 0;
#X connect 17 2 23 0;
#X connect 17 3 22 0;
#X connect 17 4 29 0;
#X connect 17 5 28 0;
#X connect 17 6 27 0;
#X connect 17 7 26 0;
#X connect 19 0 1 0;
#X connect 20 0 1 1;
#X connect 21 0 4 0;
#X connect 30 0 7 0;
#X restore 2119 719 pd l-8;
#N canvas 617 127 908 890 l-9 0;
#X msg 298 182 resize \$1;
#X obj 298 150 *;
#X obj 298 84 t b b;
#X obj 298 56 r \$0_size_arrays;
#X msg 648 150 resize \$1;
#X obj 648 56 r \$0_size_arrays;
#X msg 298 609 resize \$1;
#X obj 298 576 *;
#X obj 298 510 t b b;
#X obj 298 482 r \$0_size_arrays;
#X obj 388 543 v \$0_m;
#X obj 298 642 t a a a a, f 10;
#X obj 53 56 r \$0_const_arrays;
#X obj 53 482 r \$0_const_arrays;
#X obj 53 510 t a a a a, f 10;
#X obj 298 210 t a a a a, f 10;
#X obj 648 178 t a a a a;
#X obj 53 84 t a a a a a a a a;
#X text 299 30 // L-9;
#X obj 298 117 v \$0_nL-9;
#X obj 388 117 v \$0_nL-10;
#X obj 648 117 v \$0_nL-9;
#X obj 298 253 array define \$0_WL-9;
#X obj 298 296 array define \$0_dWL-9;
#X obj 298 339 array define \$0_VdWL-9;
#X obj 298 379 array define \$0_SdWL-9;
#X obj 648 253 array define \$0_bL-9;
#X obj 649 296 array define \$0_dbL-9;
#X obj 648 339 array define \$0_VdbL-9;
#X obj 648 379 array define \$0_SdbL-9;
#X obj 298 543 v \$0_nL-9;
#X obj 298 685 array define \$0_ZL-9;
#X obj 297 728 array define \$0_dZL-9;
#X obj 295 771 array define \$0_AL-9;
#X obj 296 814 array define \$0_dAL-9;
#X connect 0 0 15 0;
#X connect 1 0 0 0;
#X connect 2 0 19 0;
#X connect 2 1 20 0;
#X connect 3 0 2 0;
#X connect 4 0 16 0;
#X connect 5 0 21 0;
#X connect 6 0 11 0;
#X connect 7 0 6 0;
#X connect 8 0 30 0;
#X connect 8 1 10 0;
#X connect 9 0 8 0;
#X connect 10 0 7 1;
#X connect 11 0 31 0;
#X connect 11 1 32 0;
#X connect 11 2 33 0;
#X connect 11 3 34 0;
#X connect 12 0 17 0;
#X connect 13 0 14 0;
#X connect 14 0 34 0;
#X connect 14 1 33 0;
#X connect 14 2 32 0;
#X connect 14 3 31 0;
#X connect 15 0 22 0;
#X connect 15 1 23 0;
#X connect 15 2 24 0;
#X connect 15 3 25 0;
#X connect 16 0 26 0;
#X connect 16 1 27 0;
#X connect 16 2 28 0;
#X connect 16 3 29 0;
#X connect 17 0 25 0;
#X connect 17 1 24 0;
#X connect 17 2 23 0;
#X connect 17 3 22 0;
#X connect 17 4 29 0;
#X connect 17 5 28 0;
#X connect 17 6 27 0;
#X connect 17 7 26 0;
#X connect 19 0 1 0;
#X connect 20 0 1 1;
#X connect 21 0 4 0;
#X connect 30 0 7 0;
#X restore 2119 752 pd l-9;
#X text 2105 688 // more arrays;
#X connect 0 0 1 0;
#X connect 2 0 30 0;
#X connect 3 0 186 0;
#X connect 4 0 3 0;
#X connect 5 0 15 0;
#X connect 5 1 16 0;
#X connect 6 0 5 0;
#X connect 7 0 187 0;
#X connect 8 0 19 0;
#X connect 9 0 27 0;
#X connect 10 0 9 0;
#X connect 11 0 22 0;
#X connect 11 1 13 0;
#X connect 12 0 11 0;
#X connect 13 0 10 1;
#X connect 15 0 4 0;
#X connect 16 0 4 1;
#X connect 19 0 7 0;
#X connect 22 0 10 0;
#X connect 27 0 23 0;
#X connect 27 1 24 0;
#X connect 27 2 25 0;
#X connect 27 3 26 0;
#X connect 31 0 188 0;
#X connect 32 0 119 0;
#X connect 33 0 191 0;
#X connect 34 0 33 0;
#X connect 35 0 47 0;
#X connect 35 1 48 0;
#X connect 36 0 35 0;
#X connect 37 0 192 0;
#X connect 38 0 49 0;
#X connect 39 0 44 0;
#X connect 40 0 39 0;
#X connect 41 0 61 0;
#X connect 41 1 43 0;
#X connect 42 0 41 0;
#X connect 43 0 40 1;
#X connect 44 0 56 0;
#X connect 44 1 58 0;
#X connect 44 2 57 0;
#X connect 44 3 59 0;
#X connect 45 0 193 0;
#X connect 46 0 120 0;
#X connect 47 0 34 0;
#X connect 48 0 34 1;
#X connect 49 0 37 0;
#X connect 61 0 40 0;
#X connect 62 0 196 0;
#X connect 63 0 62 0;
#X connect 64 0 77 0;
#X connect 64 1 123 0;
#X connect 65 0 64 0;
#X connect 66 0 197 0;
#X connect 67 0 78 0;
#X connect 68 0 73 0;
#X connect 69 0 68 0;
#X connect 70 0 85 0;
#X connect 70 1 72 0;
#X connect 71 0 70 0;
#X connect 72 0 69 1;
#X connect 73 0 86 0;
#X connect 73 1 88 0;
#X connect 73 2 87 0;
#X connect 73 3 89 0;
#X connect 74 0 198 0;
#X connect 75 0 121 0;
#X connect 77 0 63 0;
#X connect 78 0 66 0;
#X connect 85 0 69 0;
#X connect 90 0 201 0;
#X connect 91 0 90 0;
#X connect 92 0 106 0;
#X connect 92 1 124 0;
#X connect 93 0 92 0;
#X connect 94 0 202 0;
#X connect 95 0 107 0;
#X connect 96 0 101 0;
#X connect 97 0 96 0;
#X connect 98 0 114 0;
#X connect 98 1 100 0;
#X connect 99 0 98 0;
#X connect 100 0 97 1;
#X connect 101 0 115 0;
#X connect 101 1 117 0;
#X connect 101 2 116 0;
#X connect 101 3 118 0;
#X connect 102 0 203 0;
#X connect 103 0 122 0;
#X connect 104 0 2 0;
#X connect 106 0 91 0;
#X connect 107 0 94 0;
#X connect 114 0 97 0;
#X connect 119 0 23 0;
#X connect 119 1 24 0;
#X connect 119 2 25 0;
#X connect 119 3 26 0;
#X connect 120 0 56 0;
#X connect 120 1 58 0;
#X connect 120 2 57 0;
#X connect 120 3 59 0;
#X connect 121 0 86 0;
#X connect 121 1 88 0;
#X connect 121 2 87 0;
#X connect 121 3 89 0;
#X connect 122 0 115 0;
#X connect 122 1 117 0;
#X connect 122 2 116 0;
#X connect 122 3 118 0;
#X connect 123 0 63 1;
#X connect 124 0 91 1;
#X connect 125 0 206 0;
#X connect 126 0 125 0;
#X connect 127 0 141 0;
#X connect 127 1 142 0;
#X connect 128 0 127 0;
#X connect 129 0 207 0;
#X connect 130 0 143 0;
#X connect 131 0 136 0;
#X connect 132 0 131 0;
#X connect 133 0 150 0;
#X connect 133 1 135 0;
#X connect 134 0 133 0;
#X connect 135 0 132 1;
#X connect 136 0 151 0;
#X connect 136 1 153 0;
#X connect 136 2 152 0;
#X connect 136 3 154 0;
#X connect 137 0 208 0;
#X connect 138 0 139 0;
#X connect 139 0 151 0;
#X connect 139 1 153 0;
#X connect 139 2 152 0;
#X connect 139 3 154 0;
#X connect 141 0 126 0;
#X connect 142 0 126 1;
#X connect 143 0 129 0;
#X connect 150 0 132 0;
#X connect 155 0 212 0;
#X connect 156 0 155 0;
#X connect 157 0 171 0;
#X connect 157 1 209 0;
#X connect 158 0 157 0;
#X connect 159 0 213 0;
#X connect 160 0 172 0;
#X connect 161 0 166 0;
#X connect 162 0 161 0;
#X connect 163 0 179 0;
#X connect 163 1 165 0;
#X connect 164 0 163 0;
#X connect 165 0 162 1;
#X connect 166 0 180 0;
#X connect 166 1 182 0;
#X connect 166 2 181 0;
#X connect 166 3 183 0;
#X connect 167 0 214 0;
#X connect 168 0 169 0;
#X connect 169 0 180 0;
#X connect 169 1 182 0;
#X connect 169 2 181 0;
#X connect 169 3 183 0;
#X connect 171 0 156 0;
#X connect 172 0 159 0;
#X connect 179 0 162 0;
#X connect 186 0 17 0;
#X connect 186 1 18 0;
#X connect 186 2 28 0;
#X connect 186 3 184 0;
#X connect 187 0 20 0;
#X connect 187 1 21 0;
#X connect 187 2 29 0;
#X connect 187 3 185 0;
#X connect 188 0 17 0;
#X connect 188 1 18 0;
#X connect 188 2 28 0;
#X connect 188 3 20 0;
#X connect 188 4 21 0;
#X connect 188 5 29 0;
#X connect 188 6 184 0;
#X connect 188 7 185 0;
#X connect 191 0 50 0;
#X connect 191 1 51 0;
#X connect 191 2 52 0;
#X connect 191 3 189 0;
#X connect 192 0 53 0;
#X connect 192 1 54 0;
#X connect 192 2 55 0;
#X connect 192 3 190 0;
#X connect 193 0 50 0;
#X connect 193 1 51 0;
#X connect 193 2 52 0;
#X connect 193 3 53 0;
#X connect 193 4 54 0;
#X connect 193 5 55 0;
#X connect 193 6 189 0;
#X connect 193 7 190 0;
#X connect 196 0 79 0;
#X connect 196 1 80 0;
#X connect 196 2 81 0;
#X connect 196 3 194 0;
#X connect 197 0 82 0;
#X connect 197 1 83 0;
#X connect 197 2 84 0;
#X connect 197 3 195 0;
#X connect 198 0 79 0;
#X connect 198 1 80 0;
#X connect 198 2 81 0;
#X connect 198 3 82 0;
#X connect 198 4 83 0;
#X connect 198 5 84 0;
#X connect 198 6 194 0;
#X connect 198 7 195 0;
#X connect 201 0 108 0;
#X connect 201 1 109 0;
#X connect 201 2 110 0;
#X connect 201 3 199 0;
#X connect 202 0 111 0;
#X connect 202 1 112 0;
#X connect 202 2 113 0;
#X connect 202 3 200 0;
#X connect 203 0 108 0;
#X connect 203 1 109 0;
#X connect 203 2 110 0;
#X connect 203 3 111 0;
#X connect 203 4 112 0;
#X connect 203 5 113 0;
#X connect 203 6 199 0;
#X connect 203 7 200 0;
#X connect 206 0 144 0;
#X connect 206 1 145 0;
#X connect 206 2 146 0;
#X connect 206 3 204 0;
#X connect 207 0 147 0;
#X connect 207 1 148 0;
#X connect 207 2 149 0;
#X connect 207 3 205 0;
#X connect 208 0 144 0;
#X connect 208 1 145 0;
#X connect 208 2 146 0;
#X connect 208 3 147 0;
#X connect 208 4 148 0;
#X connect 208 5 149 0;
#X connect 208 6 204 0;
#X connect 208 7 205 0;
#X connect 209 0 156 1;
#X connect 212 0 173 0;
#X connect 212 1 174 0;
#X connect 212 2 175 0;
#X connect 212 3 210 0;
#X connect 213 0 176 0;
#X connect 213 1 177 0;
#X connect 213 2 178 0;
#X connect 213 3 211 0;
#X connect 214 0 173 0;
#X connect 214 1 174 0;
#X connect 214 2 175 0;
#X connect 214 3 176 0;
#X connect 214 4 177 0;
#X connect 214 5 178 0;
#X connect 214 6 210 0;
#X connect 214 7 211 0;
#X connect 216 0 231 0;
#X connect 217 0 216 0;
#X connect 218 0 235 0;
#X connect 218 1 236 0;
#X connect 219 0 218 0;
#X connect 220 0 232 0;
#X connect 221 0 237 0;
#X connect 222 0 227 0;
#X connect 223 0 222 0;
#X connect 224 0 246 0;
#X connect 224 1 226 0;
#X connect 225 0 224 0;
#X connect 226 0 223 1;
#X connect 227 0 247 0;
#X connect 227 1 249 0;
#X connect 227 2 248 0;
#X connect 227 3 250 0;
#X connect 228 0 233 0;
#X connect 229 0 230 0;
#X connect 230 0 247 0;
#X connect 230 1 249 0;
#X connect 230 2 248 0;
#X connect 230 3 250 0;
#X connect 231 0 238 0;
#X connect 231 1 239 0;
#X connect 231 2 240 0;
#X connect 231 3 241 0;
#X connect 232 0 242 0;
#X connect 232 1 243 0;
#X connect 232 2 244 0;
#X connect 232 3 245 0;
#X connect 233 0 238 0;
#X connect 233 1 239 0;
#X connect 233 2 240 0;
#X connect 233 3 242 0;
#X connect 233 4 243 0;
#X connect 233 5 244 0;
#X connect 233 6 241 0;
#X connect 233 7 245 0;
#X connect 235 0 217 0;
#X connect 236 0 217 1;
#X connect 237 0 220 0;
#X connect 246 0 223 0;
#X connect 251 0 266 0;
#X connect 252 0 251 0;
#X connect 253 0 270 0;
#X connect 253 1 271 0;
#X connect 254 0 253 0;
#X connect 255 0 267 0;
#X connect 256 0 272 0;
#X connect 257 0 262 0;
#X connect 258 0 257 0;
#X connect 259 0 281 0;
#X connect 259 1 261 0;
#X connect 260 0 259 0;
#X connect 261 0 258 1;
#X connect 262 0 282 0;
#X connect 262 1 284 0;
#X connect 262 2 283 0;
#X connect 262 3 285 0;
#X connect 263 0 268 0;
#X connect 264 0 265 0;
#X connect 265 0 282 0;
#X connect 265 1 284 0;
#X connect 265 2 283 0;
#X connect 265 3 285 0;
#X connect 266 0 273 0;
#X connect 266 1 274 0;
#X connect 266 2 275 0;
#X connect 266 3 276 0;
#X connect 267 0 277 0;
#X connect 267 1 278 0;
#X connect 267 2 279 0;
#X connect 267 3 280 0;
#X connect 268 0 273 0;
#X connect 268 1 274 0;
#X connect 268 2 275 0;
#X connect 268 3 277 0;
#X connect 268 4 278 0;
#X connect 268 5 279 0;
#X connect 268 6 276 0;
#X connect 268 7 280 0;
#X connect 270 0 252 0;
#X connect 271 0 252 1;
#X connect 272 0 255 0;
#X connect 281 0 258 0;
#X restore 17 341 pd arrays;
#X msg 86 308 bang;
#N canvas 1499 622 521 409 resize_X_and_Y 0;
#X obj 66 248 array size \$0_X;
#X obj 92 154 v \$0_m;
#X obj 150 154 v \$0_nx;
#X obj 92 187 *;
#X msg 66 93 bang;
#X obj 66 121 t b b b;
#X obj 252 154 v \$0_m;
#X obj 252 187 *;
#X msg 226 93 bang;
#X obj 226 121 t b b b;
#X obj 310 154 v \$0_ny;
#X obj 226 248 array size \$0_Y;
#X obj 66 12 inlet bang;
#X obj 66 40 t b b;
#X obj 66 276 outlet X_size;
#X obj 226 276 outlet Y_size;
#X connect 0 0 14 0;
#X connect 1 0 3 0;
#X connect 2 0 3 1;
#X connect 3 0 0 0;
#X connect 4 0 5 0;
#X connect 5 0 0 0;
#X connect 5 1 1 0;
#X connect 5 2 2 0;
#X connect 6 0 7 0;
#X connect 7 0 11 0;
#X connect 8 0 9 0;
#X connect 9 0 11 0;
#X connect 9 1 6 0;
#X connect 9 2 10 0;
#X connect 10 0 7 1;
#X connect 11 0 15 0;
#X connect 12 0 13 0;
#X connect 13 0 4 0;
#X connect 13 1 8 0;
#X restore 496 341 pd resize_X_and_Y;
#X msg 496 308 bang;
#X obj 154 26 bng 40 250 50 0 \$0_init \$0_refresh init 0 -12 0 16 #fcfcfc #000000 #000000;
#X obj 240 59 v \$0_leak;
#X obj 240 30 nbx 5 21 0 1 0 1 empty \$0_init leak 0 -12 0 16 #fcfcfc #000000 #000000 0.02 256;
#X obj 380 30 nbx 6 21 0.01 1 1 1 empty \$0_init alpha 0 -12 0 16 #fcfcfc #000000 #000000 0.01 256;
#N canvas 1774 81 1609 1281 initialize_params 0;
#X obj 154 46 inlet;
#X obj 1209 124 v \$0_nx;
#X obj 154 124 v \$0_nL-0;
#X obj 246 124 v \$0_nL-1;
#X obj 344 124 v \$0_nL-2;
#X obj 442 124 v \$0_nL-3;
#X obj 540 124 v \$0_nL-4;
#X obj 638 124 v \$0_nL-5;
#X obj 736 124 v \$0_nL-6;
#X obj 834 124 v \$0_nL-7;
#X obj 932 124 v \$0_nL-8;
#X obj 1030 124 v \$0_nL-9;
#X obj 1067 283 cml.he_initialization;
#X obj 1232 250 v \$0_ns;
#X obj 1067 185 pack f f;
#X obj 1067 246 t b a b;
#X msg 1067 218 layer 9 \, layer_dims \$1 \$2;
#X obj 1030 152 t f f;
#X obj 932 152 t f f;
#X obj 834 152 t f f;
#X obj 736 152 t f f;
#X obj 638 152 t f f;
#X obj 540 152 t f f;
#X obj 442 152 t f f;
#X obj 344 152 t f f;
#X obj 246 152 t f f;
#X obj 969 381 cml.he_initialization;
#X obj 1134 348 v \$0_ns;
#X obj 969 283 pack f f;
#X obj 969 344 t b a b;
#X msg 969 316 layer 8 \, layer_dims \$1 \$2;
#X obj 871 479 cml.he_initialization;
#X obj 1036 446 v \$0_ns;
#X obj 871 381 pack f f;
#X obj 871 442 t b a b;
#X msg 871 414 layer 7 \, layer_dims \$1 \$2;
#X obj 773 577 cml.he_initialization;
#X obj 938 544 v \$0_ns;
#X obj 773 479 pack f f;
#X obj 773 540 t b a b;
#X msg 773 512 layer 6 \, layer_dims \$1 \$2;
#X obj 675 675 cml.he_initialization;
#X obj 840 642 v \$0_ns;
#X obj 675 577 pack f f;
#X obj 675 638 t b a b;
#X msg 675 610 layer 5 \, layer_dims \$1 \$2;
#X obj 577 773 cml.he_initialization;
#X obj 742 740 v \$0_ns;
#X obj 577 675 pack f f;
#X obj 577 736 t b a b;
#X msg 577 708 layer 4 \, layer_dims \$1 \$2;
#X obj 479 871 cml.he_initialization;
#X obj 644 838 v \$0_ns;
#X obj 479 773 pack f f;
#X obj 479 834 t b a b;
#X msg 479 806 layer 3 \, layer_dims \$1 \$2;
#X obj 381 969 cml.he_initialization;
#X obj 546 936 v \$0_ns;
#X obj 381 871 pack f f;
#X obj 381 932 t b a b;
#X obj 283 1067 cml.he_initialization;
#X obj 448 1034 v \$0_ns;
#X obj 283 969 pack f f;
#X obj 283 1030 t b a b;
#X obj 153 1165 cml.he_initialization;
#X obj 318 1132 v \$0_ns;
#X obj 153 1067 pack f f, f 12;
#X obj 153 1128 t b a b;
#X msg 381 904 layer 2 \, layer_dims \$1 \$2;
#X msg 283 1002 layer 1 \, layer_dims \$1 \$2;
#X msg 153 1100 layer 0 \, layer_dims \$1 \$2;
#X obj 154 74 t b b b b b b b b b b b, f 114;
#X text 1296 125 // Set right inlet of initial layer to nx \;;
#X connect 0 0 71 0;
#X connect 1 0 14 1;
#X connect 2 0 66 0;
#X connect 3 0 25 0;
#X connect 4 0 24 0;
#X connect 5 0 23 0;
#X connect 6 0 22 0;
#X connect 7 0 21 0;
#X connect 8 0 20 0;
#X connect 9 0 19 0;
#X connect 10 0 18 0;
#X connect 11 0 17 0;
#X connect 13 0 12 1;
#X connect 14 0 16 0;
#X connect 15 0 12 0;
#X connect 15 1 12 0;
#X connect 15 2 13 0;
#X connect 16 0 15 0;
#X connect 17 0 28 1;
#X connect 17 1 14 0;
#X connect 18 0 33 1;
#X connect 18 1 28 0;
#X connect 19 0 38 1;
#X connect 19 1 33 0;
#X connect 20 0 43 1;
#X connect 20 1 38 0;
#X connect 21 0 48 1;
#X connect 21 1 43 0;
#X connect 22 0 53 1;
#X connect 22 1 48 0;
#X connect 23 0 58 1;
#X connect 23 1 53 0;
#X connect 24 0 62 1;
#X connect 24 1 58 0;
#X connect 25 0 66 1;
#X connect 25 1 62 0;
#X connect 27 0 26 1;
#X connect 28 0 30 0;
#X connect 29 0 26 0;
#X connect 29 1 26 0;
#X connect 29 2 27 0;
#X connect 30 0 29 0;
#X connect 32 0 31 1;
#X connect 33 0 35 0;
#X connect 34 0 31 0;
#X connect 34 1 31 0;
#X connect 34 2 32 0;
#X connect 35 0 34 0;
#X connect 37 0 36 1;
#X connect 38 0 40 0;
#X connect 39 0 36 0;
#X connect 39 1 36 0;
#X connect 39 2 37 0;
#X connect 40 0 39 0;
#X connect 42 0 41 1;
#X connect 43 0 45 0;
#X connect 44 0 41 0;
#X connect 44 1 41 0;
#X connect 44 2 42 0;
#X connect 45 0 44 0;
#X connect 47 0 46 1;
#X connect 48 0 50 0;
#X connect 49 0 46 0;
#X connect 49 1 46 0;
#X connect 49 2 47 0;
#X connect 50 0 49 0;
#X connect 52 0 51 1;
#X connect 53 0 55 0;
#X connect 54 0 51 0;
#X connect 54 1 51 0;
#X connect 54 2 52 0;
#X connect 55 0 54 0;
#X connect 57 0 56 1;
#X connect 58 0 68 0;
#X connect 59 0 56 0;
#X connect 59 1 56 0;
#X connect 59 2 57 0;
#X connect 61 0 60 1;
#X connect 62 0 69 0;
#X connect 63 0 60 0;
#X connect 63 1 60 0;
#X connect 63 2 61 0;
#X connect 65 0 64 1;
#X connect 66 0 70 0;
#X connect 67 0 64 0;
#X connect 67 1 64 0;
#X connect 67 2 65 0;
#X connect 68 0 59 0;
#X connect 69 0 63 0;
#X connect 70 0 67 0;
#X connect 71 0 2 0;
#X connect 71 1 3 0;
#X connect 71 2 4 0;
#X connect 71 3 5 0;
#X connect 71 4 6 0;
#X connect 71 5 7 0;
#X connect 71 6 8 0;
#X connect 71 7 9 0;
#X connect 71 8 10 0;
#X connect 71 9 11 0;
#X connect 71 10 1 0;
#X restore 307 341 pd initialize_params;
#X msg 307 308 bang;
#X obj 663 27 nbx 5 21 0.01 1 1 1 empty \$0_init mu 0 -12 0 16 #fcfcfc #000000 #000000 0.9 256;
#X obj 663 56 s \$0_beta;
#X obj 380 59 s \$0_alpha;
#X obj 771 30 nbx 5 21 0.01 1 1 1 empty \$0_init rho 0 -12 0 16 #fcfcfc #000000 #000000 0.999 256;
#X obj 770 59 s \$0_rho;
#N canvas 1495 611 450 250 (subpatch) 0;
#X array \$0_X 4 float 3;
#A 0 0.1 0.2 0.3 0.4;
#X coords 0 1 4 -1 200 140 1;
#X restore 16 397 graph;
#N canvas 0 50 450 250 (subpatch) 0;
#X array \$0_Y 4 float 3;
#A 0 0.1 0.5 0.2 0.4;
#X coords 0 1 4 -1 200 140 1;
#X restore 14 573 graph;
#X msg 113 167 4;
#X msg 209 167 1;
#X msg 595 167 2;
#X msg 788 167 2;
#X msg 884 167 2;
#X msg 980 167 2;
#X msg 1077 167 2;
#X obj 1077 195 v \$0_nL-7;
#X msg 1173 167 2;
#X obj 1173 195 v \$0_nL-8;
#X msg 1270 167 2;
#X obj 1270 195 v \$0_nL-9;
#X obj 17 134 t b b b b b b b b b b b b b b, f 157;
#X text 134 309 // Zero all arrays \;;
#X msg 498 167 2;
#X obj 316 444 array define \$0_expectations;
#X msg 691 167 1;
#N canvas 307 93 2325 1282 test_backward_outer_dz 0;
#X obj 467 315 v \$0_ns;
#X obj 33 414 array set, f 41;
#X obj 33 282 t b b b, f 45;
#X msg 33 249 bang;
#X obj 493 524 v \$0_ns;
#X obj 35 620 array set, f 42;
#X obj 35 488 t b b b, f 49;
#X msg 35 455 bang;
#X obj 368 525 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 1772 117 v \$0_ns;
#X obj 1314 81 t b b b, f 49;
#X msg 1314 48 bang;
#X obj 1647 118 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 1314 213 array get, f 42;
#X obj 1314 241 t l l, f 35;
#X obj 1647 178 t s s;
#X obj 1591 274 list prepend;
#X obj 1591 302 list trim;
#X obj 1591 330 print values \$1;
#X obj 703 142 t b a b, f 17;
#X obj 836 172 v \$0_ns;
#X obj 1611 753 cml.d0;
#X obj 1656 720 v \$0_ns;
#X msg 1611 659 expectations;
#X obj 1611 781 t s s s;
#X obj 1587 830 array size;
#X obj 1547 753 v \$0_m;
#X obj 1457 786 *;
#X obj 1446 944 array set;
#X obj 1542 1067 array get;
#X msg 1314 478 bang;
#X obj 1611 687 t a b;
#X obj 1315 911 cml.range;
#X obj 1457 814 t f f;
#X obj 1315 878 f;
#X msg 1572 1030 1;
#X obj 1962 716 v \$0_ns;
#X obj 1837 717 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 1837 777 t b s;
#X obj 1805 1039 array get;
#X msg 1838 1005 1;
#X obj 1315 939 t f b f;
#X obj 1542 1171 print values match;
#X obj 1542 1118 expr abs($f1 - $f2) < 1e-07;
#X obj 1837 684 t b b;
#X obj 1315 505 t b b b b b b, f 14;
#X text 1622 883 // manually calculated \;;
#X text 1318 15 // Inspect the results \;;
#X text 1317 435 // Compare actual to expected \;;
#X text 1790 1114 // Deal with floating point differences between expected and actual \;;
#X obj 358 348 cml.label_name;
#X msg 33 381 0.1 0.5 0.2 0.4;
#X text 45 27 // input layer 0 \, (nL-0 \, nL-1) (1 \, 2) \;;
#X obj 368 557 cml.array_name A;
#X obj 703 205 cml.outer_dz;
#X msg 703 94 m 4 \, num_outputs 1;
#X text 702 58 // Trigger dZ calculation \;;
#X obj 1647 150 cml.array_name dZ;
#X obj 1457 753 v \$0_nL-0;
#X obj 1837 749 cml.array_name dZ;
#X msg 35 587 -0.1 -0.2 0.1 0.8, f 43;
#X msg 1446 911 -0.2 -0.7 -0.1 0.4;
#X text 50 62 // NOTE: only implemented for linear activations so far \; The formula simplfies to dZ = (AL - Y) \; Negative dz values indicate that the predicted output was too low.;
#X connect 0 0 50 1;
#X connect 2 0 51 0;
#X connect 2 1 50 0;
#X connect 2 2 0 0;
#X connect 3 0 2 0;
#X connect 4 0 53 1;
#X connect 6 0 60 0;
#X connect 6 1 8 0;
#X connect 6 2 4 0;
#X connect 7 0 6 0;
#X connect 8 0 53 0;
#X connect 9 0 57 1;
#X connect 10 0 13 0;
#X connect 10 1 12 0;
#X connect 10 2 9 0;
#X connect 11 0 10 0;
#X connect 12 0 57 0;
#X connect 13 0 14 0;
#X connect 14 1 16 0;
#X connect 15 0 13 2;
#X connect 15 1 16 1;
#X connect 16 0 17 0;
#X connect 17 0 18 0;
#X connect 19 0 54 0;
#X connect 19 1 54 0;
#X connect 19 2 20 0;
#X connect 20 0 54 1;
#X connect 21 0 24 0;
#X connect 22 0 21 1;
#X connect 23 0 31 0;
#X connect 24 0 29 2;
#X connect 24 1 28 2;
#X connect 24 2 25 1;
#X connect 26 0 27 1;
#X connect 27 0 33 0;
#X connect 29 0 43 0;
#X connect 30 0 45 0;
#X connect 31 0 21 0;
#X connect 31 1 22 0;
#X connect 32 0 41 0;
#X connect 33 0 34 1;
#X connect 33 1 25 0;
#X connect 34 0 32 0;
#X connect 35 0 29 1;
#X connect 36 0 59 1;
#X connect 37 0 59 0;
#X connect 38 0 40 0;
#X connect 38 1 39 2;
#X connect 39 0 43 1;
#X connect 40 0 39 1;
#X connect 41 0 29 0;
#X connect 41 1 35 0;
#X connect 41 2 39 0;
#X connect 43 0 42 0;
#X connect 44 0 37 0;
#X connect 44 1 36 0;
#X connect 45 0 34 0;
#X connect 45 1 61 0;
#X connect 45 2 58 0;
#X connect 45 3 26 0;
#X connect 45 4 23 0;
#X connect 45 5 44 0;
#X connect 50 0 1 2;
#X connect 51 0 1 0;
#X connect 53 0 5 2;
#X connect 55 0 19 0;
#X connect 57 0 15 0;
#X connect 58 0 27 0;
#X connect 59 0 38 0;
#X connect 60 0 5 0;
#X connect 61 0 28 0;
#X restore 305 518 pd test_backward_outer_dz;
#N canvas 76 103 2534 1282 test_backward_linear_dw_gd_output_layer_2_1 0;
#X text 45 27 // layer 0 \, (nL-0 \, nL-1) (1 \, 2) \;;
#X obj 467 235 v \$0_ns;
#X obj 33 334 array set, f 41;
#X obj 33 202 t b b b, f 45;
#X msg 33 169 bang;
#X obj 493 444 v \$0_ns;
#X obj 35 540 array set, f 42;
#X obj 35 408 t b b b, f 49;
#X msg 35 375 bang;
#X obj 368 445 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 1772 117 v \$0_ns;
#X obj 1314 81 t b b b, f 49;
#X msg 1314 48 bang;
#X obj 1647 118 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 1314 213 array get, f 42;
#X obj 1314 241 t l l, f 35;
#X obj 1647 178 t s s;
#X obj 1591 274 list prepend;
#X obj 1591 302 list trim;
#X obj 1591 330 print values \$1;
#X obj 703 142 t b a b, f 17;
#X obj 836 172 v \$0_ns;
#X obj 1611 753 cml.d0;
#X obj 1656 720 v \$0_ns;
#X msg 1611 659 expectations;
#X obj 1611 781 t s s s;
#X obj 1587 830 array size;
#X obj 1437 766 *;
#X obj 1446 944 array set;
#X obj 1542 1067 array get;
#X msg 1314 478 bang;
#X obj 1611 687 t a b;
#X obj 1315 911 cml.range;
#X obj 1437 794 t f f;
#X obj 1315 878 f;
#X msg 1572 1030 1;
#X obj 1962 716 v \$0_ns;
#X obj 1837 717 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 1837 777 t b s;
#X obj 1805 1039 array get;
#X msg 1838 1005 1;
#X obj 1315 939 t f b f;
#X obj 1542 1171 print values match;
#X obj 1542 1118 expr abs($f1 - $f2) < 1e-07;
#X obj 1837 684 t b b;
#X obj 1315 505 t b b b b b b, f 14;
#X text 1622 883 // manually calculated \;;
#X text 1318 15 // Inspect the results \;;
#X text 1317 435 // Compare actual to expected \;;
#X text 1790 1114 // Deal with floating point differences between expected and actual \;;
#X obj 358 268 cml.label_name;
#X msg 33 301 0.1 0.5 0.2 0.4;
#X obj 368 477 cml.array_name A;
#X obj 703 205 cml.outer_dz;
#X msg 703 94 m 4 \, num_outputs 1;
#X text 702 58 // Trigger dZ calculation \;;
#X obj 1647 150 cml.array_name dZ;
#X obj 1437 733 v \$0_nL-0;
#X msg 35 507 -0.1 -0.2 0.1 0.8, f 43;
#X obj 706 433 cml.layer_backward;
#X msg 707 320 layer_number 0 \, layer_dims 1 2 \, m 4 \, activation linear \, skip_dz 1 \, gd 1;
#X text 36 75 // dW = 1/m dZ^[l]A^[l-1]T \;;
#X obj 493 704 v \$0_ns;
#X obj 35 800 array set, f 42;
#X obj 35 668 t b b b, f 49;
#X msg 35 635 bang;
#X obj 368 705 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 1 256;
#X obj 368 737 cml.array_name A;
#X text 32 131 // calculate dZ/dA;
#X msg 35 767 -0.5 -0.4 -0.3 -0.2 0.1 0.2 0.3 0.4, f 43;
#X text 704 252 // dZL-0 = -0.2 -0.7 -0.1 0.4;
#X obj 2312 117 v \$0_ns;
#X obj 1854 81 t b b b, f 49;
#X msg 1854 48 bang;
#X obj 2187 118 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 1854 213 array get, f 42;
#X obj 1854 241 t l l, f 35;
#X obj 2187 178 t s s;
#X obj 2131 274 list prepend;
#X obj 2131 302 list trim;
#X obj 2131 330 print values \$1;
#X obj 2187 150 cml.array_name dW;
#X obj 847 402 v \$0_ns;
#X obj 707 366 t b a b;
#X obj 1837 749 cml.array_name dW;
#X msg 1446 911 0.0825 -0.0075;
#X obj 1527 733 v \$0_nL-1;
#X connect 1 0 50 1;
#X connect 3 0 51 0;
#X connect 3 1 50 0;
#X connect 3 2 1 0;
#X connect 4 0 3 0;
#X connect 5 0 52 1;
#X connect 7 0 58 0;
#X connect 7 1 9 0;
#X connect 7 2 5 0;
#X connect 8 0 7 0;
#X connect 9 0 52 0;
#X connect 10 0 56 1;
#X connect 11 0 14 0;
#X connect 11 1 13 0;
#X connect 11 2 10 0;
#X connect 12 0 11 0;
#X connect 13 0 56 0;
#X connect 14 0 15 0;
#X connect 15 1 17 0;
#X connect 16 0 14 2;
#X connect 16 1 17 1;
#X connect 17 0 18 0;
#X connect 18 0 19 0;
#X connect 20 0 53 0;
#X connect 20 1 53 0;
#X connect 20 2 21 0;
#X connect 21 0 53 1;
#X connect 22 0 25 0;
#X connect 23 0 22 1;
#X connect 24 0 31 0;
#X connect 25 0 29 2;
#X connect 25 1 28 2;
#X connect 25 2 26 1;
#X connect 27 0 33 0;
#X connect 29 0 43 0;
#X connect 30 0 45 0;
#X connect 31 0 22 0;
#X connect 31 1 23 0;
#X connect 32 0 41 0;
#X connect 33 0 34 1;
#X connect 33 1 26 0;
#X connect 34 0 32 0;
#X connect 35 0 29 1;
#X connect 36 0 84 1;
#X connect 37 0 84 0;
#X connect 38 0 40 0;
#X connect 38 1 39 2;
#X connect 39 0 43 1;
#X connect 40 0 39 1;
#X connect 41 0 29 0;
#X connect 41 1 35 0;
#X connect 41 2 39 0;
#X connect 43 0 42 0;
#X connect 44 0 37 0;
#X connect 44 1 36 0;
#X connect 45 0 34 0;
#X connect 45 1 85 0;
#X connect 45 2 57 0;
#X connect 45 3 86 0;
#X connect 45 4 24 0;
#X connect 45 5 44 0;
#X connect 50 0 2 2;
#X connect 51 0 2 0;
#X connect 52 0 6 2;
#X connect 54 0 20 0;
#X connect 56 0 16 0;
#X connect 57 0 27 0;
#X connect 58 0 6 0;
#X connect 60 0 83 0;
#X connect 62 0 67 1;
#X connect 64 0 69 0;
#X connect 64 1 66 0;
#X connect 64 2 62 0;
#X connect 65 0 64 0;
#X connect 66 0 67 0;
#X connect 67 0 63 2;
#X connect 69 0 63 0;
#X connect 71 0 81 1;
#X connect 72 0 75 0;
#X connect 72 1 74 0;
#X connect 72 2 71 0;
#X connect 73 0 72 0;
#X connect 74 0 81 0;
#X connect 75 0 76 0;
#X connect 76 1 78 0;
#X connect 77 0 75 2;
#X connect 77 1 78 1;
#X connect 78 0 79 0;
#X connect 79 0 80 0;
#X connect 81 0 77 0;
#X connect 82 0 59 1;
#X connect 83 0 59 0;
#X connect 83 1 59 0;
#X connect 83 2 82 0;
#X connect 84 0 38 0;
#X connect 85 0 28 0;
#X connect 86 0 27 1;
#X restore 305 587 pd test_backward_linear_dw_gd_output_layer_2_1;
#N canvas 4 70 1712 1332 test_backward_linear_dw_momentum_and_rmsprop_output_layer_2_1 0;
#X text 45 27 // layer 0 \, (nL-0 \, nL-1) (1 \, 2) \;;
#X obj 467 355 v \$0_ns;
#X obj 33 454 array set, f 41;
#X obj 33 322 t b b b, f 45;
#X msg 33 289 bang;
#X obj 493 564 v \$0_ns;
#X obj 35 660 array set, f 42;
#X obj 35 528 t b b b, f 49;
#X msg 35 495 bang;
#X obj 368 565 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 1772 117 v \$0_ns;
#X obj 1314 81 t b b b, f 49;
#X msg 1314 48 bang;
#X obj 1647 118 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 1314 213 array get, f 42;
#X obj 1314 241 t l l, f 35;
#X obj 1647 178 t s s;
#X obj 1591 274 list prepend;
#X obj 1591 302 list trim;
#X obj 1591 330 print values \$1;
#X obj 703 142 t b a b, f 17;
#X obj 836 172 v \$0_ns;
#X msg 1260 500 bang;
#X text 1318 15 // Inspect the results \;;
#X text 707 635 // Compare actual to expected \;;
#X obj 358 388 cml.label_name;
#X msg 33 421 0.1 0.5 0.2 0.4;
#X obj 368 597 cml.array_name A;
#X obj 703 205 cml.outer_dz;
#X msg 703 94 m 4 \, num_outputs 1;
#X text 702 58 // Trigger dZ calculation \;;
#X obj 1647 150 cml.array_name dZ;
#X msg 35 627 -0.1 -0.2 0.1 0.8, f 43;
#X obj 706 583 cml.layer_backward;
#X text 36 75 // dW = 1/m dZ^[l]A^[l-1]T \;;
#X obj 493 824 v \$0_ns;
#X obj 35 920 array set, f 42;
#X obj 35 788 t b b b, f 49;
#X msg 35 755 bang;
#X obj 368 825 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 1 256;
#X obj 368 857 cml.array_name A;
#X text 32 251 // calculate dZ/dA;
#X msg 35 887 -0.5 -0.4 -0.3 -0.2 0.1 0.2 0.3 0.4, f 43;
#X text 704 252 // dZL-0 = -0.2 -0.7 -0.1 0.4;
#X obj 2312 117 v \$0_ns;
#X obj 1854 81 t b b b, f 49;
#X msg 1854 48 bang;
#X obj 2187 118 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 1854 213 array get, f 42;
#X obj 1854 241 t l l, f 35;
#X obj 2187 178 t s s;
#X obj 2131 274 list prepend;
#X obj 2131 302 list trim;
#X obj 2131 330 print values \$1;
#X obj 2187 150 cml.array_name dW;
#X obj 847 552 v \$0_ns;
#X text 705 273 // NOTE: there's a bug where unused optimization algorithms may need to be added to the options \;;
#X obj 2312 427 v \$0_ns;
#X obj 1854 391 t b b b, f 49;
#X msg 1854 358 bang;
#X obj 2187 428 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 1854 523 array get, f 42;
#X obj 1854 551 t l l, f 35;
#X obj 2187 488 t s s;
#X obj 2131 584 list prepend;
#X obj 2131 612 list trim;
#X obj 2131 640 print values \$1;
#X obj 2187 460 cml.array_name VdW;
#X obj 2131 700 print values \$1;
#X obj 2312 797 v \$0_ns;
#X obj 1854 761 t b b b, f 49;
#X msg 1854 728 bang;
#X obj 2187 798 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 1854 893 array get, f 42;
#X obj 1854 921 t l l, f 35;
#X obj 2187 858 t s s;
#X obj 2131 954 list prepend;
#X obj 2131 982 list trim;
#X obj 2131 1010 print values \$1;
#X obj 2187 830 cml.array_name SdW;
#X text 30 99 // VdW = mu.VdW + (1 - mu)dW \;;
#X text 30 119 // SdW = rho.SdW + (1 - rho)dW^2 \;;
#X msg 1260 580 bang;
#X msg 1260 660 bang;
#N canvas 4 363 1430 1007 test_Sdw_first 0;
#X obj 361 295 cml.d0;
#X obj 406 262 v \$0_ns;
#X msg 361 201 expectations;
#X obj 361 323 t s s s;
#X obj 337 372 array size;
#X obj 187 308 *;
#X obj 196 486 array set;
#X obj 292 609 array get;
#X obj 361 229 t a b;
#X obj 65 453 cml.range;
#X obj 187 336 t f f;
#X obj 65 420 f;
#X msg 322 572 1;
#X obj 712 258 v \$0_ns;
#X obj 587 259 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 587 319 t b s;
#X obj 555 581 array get;
#X msg 588 547 1;
#X obj 65 481 t f b f;
#X obj 292 713 print values match;
#X obj 292 660 expr abs($f1 - $f2) < 1e-07;
#X obj 587 226 t b b;
#X obj 65 47 t b b b b b b, f 14;
#X text 372 425 // manually calculated \;;
#X text 540 656 // Deal with floating point differences between expected and actual \;;
#X obj 187 275 v \$0_nL-0;
#X obj 277 275 v \$0_nL-1;
#X obj 65 12 inlet;
#X msg 196 453 6.80626e-06 5.625e-08;
#X obj 587 291 cml.array_name SdW;
#X connect 0 0 3 0;
#X connect 1 0 0 1;
#X connect 2 0 8 0;
#X connect 3 0 7 2;
#X connect 3 1 6 2;
#X connect 3 2 4 1;
#X connect 5 0 10 0;
#X connect 7 0 20 0;
#X connect 8 0 0 0;
#X connect 8 1 1 0;
#X connect 9 0 18 0;
#X connect 10 0 11 1;
#X connect 10 1 4 0;
#X connect 11 0 9 0;
#X connect 12 0 7 1;
#X connect 13 0 29 1;
#X connect 14 0 29 0;
#X connect 15 0 17 0;
#X connect 15 1 16 2;
#X connect 16 0 20 1;
#X connect 17 0 16 1;
#X connect 18 0 7 0;
#X connect 18 1 12 0;
#X connect 18 2 16 0;
#X connect 20 0 19 0;
#X connect 21 0 14 0;
#X connect 21 1 13 0;
#X connect 22 0 11 0;
#X connect 22 1 28 0;
#X connect 22 2 25 0;
#X connect 22 3 26 0;
#X connect 22 4 2 0;
#X connect 22 5 21 0;
#X connect 25 0 5 0;
#X connect 26 0 5 1;
#X connect 27 0 22 0;
#X connect 28 0 6 0;
#X connect 29 0 15 0;
#X restore 1260 693 pd test_Sdw_first;
#N canvas 375 301 1430 1007 test_VdW_first 0;
#X obj 361 295 cml.d0;
#X obj 406 262 v \$0_ns;
#X msg 361 201 expectations;
#X obj 361 323 t s s s;
#X obj 337 372 array size;
#X obj 187 308 *;
#X obj 196 486 array set;
#X obj 292 609 array get;
#X obj 361 229 t a b;
#X obj 65 453 cml.range;
#X obj 187 336 t f f;
#X obj 65 420 f;
#X msg 322 572 1;
#X obj 712 258 v \$0_ns;
#X obj 587 259 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 587 319 t b s;
#X obj 555 581 array get;
#X msg 588 547 1;
#X obj 65 481 t f b f;
#X obj 292 713 print values match;
#X obj 292 660 expr abs($f1 - $f2) < 1e-07;
#X obj 587 226 t b b;
#X obj 65 47 t b b b b b b, f 14;
#X text 372 425 // manually calculated \;;
#X text 540 656 // Deal with floating point differences between expected and actual \;;
#X obj 187 275 v \$0_nL-0;
#X obj 277 275 v \$0_nL-1;
#X obj 65 12 inlet;
#X msg 196 453 0.00825 -0.00075;
#X obj 587 291 cml.array_name VdW;
#X connect 0 0 3 0;
#X connect 1 0 0 1;
#X connect 2 0 8 0;
#X connect 3 0 7 2;
#X connect 3 1 6 2;
#X connect 3 2 4 1;
#X connect 5 0 10 0;
#X connect 7 0 20 0;
#X connect 8 0 0 0;
#X connect 8 1 1 0;
#X connect 9 0 18 0;
#X connect 10 0 11 1;
#X connect 10 1 4 0;
#X connect 11 0 9 0;
#X connect 12 0 7 1;
#X connect 13 0 29 1;
#X connect 14 0 29 0;
#X connect 15 0 17 0;
#X connect 15 1 16 2;
#X connect 16 0 20 1;
#X connect 17 0 16 1;
#X connect 18 0 7 0;
#X connect 18 1 12 0;
#X connect 18 2 16 0;
#X connect 20 0 19 0;
#X connect 21 0 14 0;
#X connect 21 1 13 0;
#X connect 22 0 11 0;
#X connect 22 1 28 0;
#X connect 22 2 25 0;
#X connect 22 3 26 0;
#X connect 22 4 2 0;
#X connect 22 5 21 0;
#X connect 25 0 5 0;
#X connect 26 0 5 1;
#X connect 27 0 22 0;
#X connect 28 0 6 0;
#X connect 29 0 15 0;
#X restore 1260 613 pd test_VdW_first;
#N canvas 992 268 1430 1007 test_dW 0;
#X obj 361 295 cml.d0;
#X obj 406 262 v \$0_ns;
#X msg 361 201 expectations;
#X obj 361 323 t s s s;
#X obj 337 372 array size;
#X obj 187 308 *;
#X obj 196 486 array set;
#X obj 292 609 array get;
#X obj 361 229 t a b;
#X obj 65 453 cml.range;
#X obj 187 336 t f f;
#X obj 65 420 f;
#X msg 322 572 1;
#X obj 712 258 v \$0_ns;
#X obj 587 259 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 587 319 t b s;
#X obj 555 581 array get;
#X msg 588 547 1;
#X obj 65 481 t f b f;
#X obj 292 713 print values match;
#X obj 292 660 expr abs($f1 - $f2) < 1e-07;
#X obj 587 226 t b b;
#X obj 65 47 t b b b b b b, f 14;
#X text 372 425 // manually calculated \;;
#X text 540 656 // Deal with floating point differences between expected and actual \;;
#X obj 187 275 v \$0_nL-0;
#X obj 587 291 cml.array_name dW;
#X msg 196 453 0.0825 -0.0075;
#X obj 277 275 v \$0_nL-1;
#X obj 65 12 inlet;
#X connect 0 0 3 0;
#X connect 1 0 0 1;
#X connect 2 0 8 0;
#X connect 3 0 7 2;
#X connect 3 1 6 2;
#X connect 3 2 4 1;
#X connect 5 0 10 0;
#X connect 7 0 20 0;
#X connect 8 0 0 0;
#X connect 8 1 1 0;
#X connect 9 0 18 0;
#X connect 10 0 11 1;
#X connect 10 1 4 0;
#X connect 11 0 9 0;
#X connect 12 0 7 1;
#X connect 13 0 26 1;
#X connect 14 0 26 0;
#X connect 15 0 17 0;
#X connect 15 1 16 2;
#X connect 16 0 20 1;
#X connect 17 0 16 1;
#X connect 18 0 7 0;
#X connect 18 1 12 0;
#X connect 18 2 16 0;
#X connect 20 0 19 0;
#X connect 21 0 14 0;
#X connect 21 1 13 0;
#X connect 22 0 11 0;
#X connect 22 1 27 0;
#X connect 22 2 25 0;
#X connect 22 3 28 0;
#X connect 22 4 2 0;
#X connect 22 5 21 0;
#X connect 25 0 5 0;
#X connect 26 0 15 0;
#X connect 27 0 6 0;
#X connect 28 0 5 1;
#X connect 29 0 22 0;
#X restore 1260 533 pd test_dW;
#X obj 707 516 t a b;
#X text 705 327 // I learned something here. Don't use [t b a b] to trigger a single bang after a comma separated message list. It will call the bang multiple times \;;
#X msg 634 477 bang;
#X msg 707 470 layer_number 0 \, layer_dims 1 2 \, m 4 \, activation linear \, skip_dz 1 \, gd 0 \, momentum 1 \, rmsprop 1 \, mu 0.9 \, rho 0.999;
#X text 711 676 // Expected for first pass \; VdW will be 0.1 x dW \; SdW will be 0.001 x dW^2 \; dW = 0.0825 -0.0075 \; 0.0825^2 = 0.00680625 \; 0.00680625 x 0.001 = 6.80626e-06 \; -0.0075^2 = 5.625e-05 \; 5.625e-05 * 0.001 = 5.625e-08 \;;
#X text 696 843 // Expected for second pass \; VdW_current = 0.00825 -0.00075 \; dW_current = 0.0825 -0.0075 \; VdW_new[0] = 0.9 * 0.00825 + 0.1 * 0.0825 \; VdW_new[1] = 0.9 * -0.00075 + 0.1 * -0.0075 \; SdW_current = 6.80616e-06 5.62492e-08 \; SdW_new[0] = 0.999 * 6.80616e-06 + 0.001 * 0.0825^2 \; SdW_new[1] = 0.999 * 5.62492e-08 + 0.001 * -0.0075^2 \;;
#X msg 1257 813 bang;
#N canvas 1145 80 1430 1007 test_VdW_second 0;
#X obj 361 295 cml.d0;
#X obj 406 262 v \$0_ns;
#X msg 361 201 expectations;
#X obj 361 323 t s s s;
#X obj 337 372 array size;
#X obj 187 308 *;
#X obj 196 486 array set;
#X obj 292 609 array get;
#X obj 361 229 t a b;
#X obj 65 453 cml.range;
#X obj 187 336 t f f;
#X obj 65 420 f;
#X msg 322 572 1;
#X obj 712 258 v \$0_ns;
#X obj 587 259 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 587 319 t b s;
#X obj 555 581 array get;
#X msg 588 547 1;
#X obj 65 481 t f b f;
#X obj 292 713 print values match;
#X obj 292 660 expr abs($f1 - $f2) < 1e-07;
#X obj 587 226 t b b;
#X obj 65 47 t b b b b b b, f 14;
#X text 372 425 // manually calculated \;;
#X text 540 656 // Deal with floating point differences between expected and actual \;;
#X obj 187 275 v \$0_nL-0;
#X obj 277 275 v \$0_nL-1;
#X obj 65 12 inlet;
#X obj 587 291 cml.array_name VdW;
#X msg 196 453 0.015675 -0.001425;
#X connect 0 0 3 0;
#X connect 1 0 0 1;
#X connect 2 0 8 0;
#X connect 3 0 7 2;
#X connect 3 1 6 2;
#X connect 3 2 4 1;
#X connect 5 0 10 0;
#X connect 7 0 20 0;
#X connect 8 0 0 0;
#X connect 8 1 1 0;
#X connect 9 0 18 0;
#X connect 10 0 11 1;
#X connect 10 1 4 0;
#X connect 11 0 9 0;
#X connect 12 0 7 1;
#X connect 13 0 28 1;
#X connect 14 0 28 0;
#X connect 15 0 17 0;
#X connect 15 1 16 2;
#X connect 16 0 20 1;
#X connect 17 0 16 1;
#X connect 18 0 7 0;
#X connect 18 1 12 0;
#X connect 18 2 16 0;
#X connect 20 0 19 0;
#X connect 21 0 14 0;
#X connect 21 1 13 0;
#X connect 22 0 11 0;
#X connect 22 1 29 0;
#X connect 22 2 25 0;
#X connect 22 3 26 0;
#X connect 22 4 2 0;
#X connect 22 5 21 0;
#X connect 25 0 5 0;
#X connect 26 0 5 1;
#X connect 27 0 22 0;
#X connect 28 0 15 0;
#X connect 29 0 6 0;
#X restore 1257 845 pd test_VdW_second;
#X text 1254 764 // click the <-bang message again to make sure calculations update correctly.;
#X msg 1260 898 bang;
#N canvas 8 395 1430 1007 test_Sdw_second 0;
#X obj 361 295 cml.d0;
#X obj 406 262 v \$0_ns;
#X msg 361 201 expectations;
#X obj 361 323 t s s s;
#X obj 337 372 array size;
#X obj 187 308 *;
#X obj 196 486 array set;
#X obj 292 609 array get;
#X obj 361 229 t a b;
#X obj 65 453 cml.range;
#X obj 187 336 t f f;
#X obj 65 420 f;
#X msg 322 572 1;
#X obj 712 258 v \$0_ns;
#X obj 587 259 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 587 319 t b s;
#X obj 555 581 array get;
#X msg 588 547 1;
#X obj 65 481 t f b f;
#X obj 292 713 print values match;
#X obj 587 226 t b b;
#X obj 65 47 t b b b b b b, f 14;
#X text 372 425 // manually calculated \;;
#X text 540 656 // Deal with floating point differences between expected and actual \;;
#X obj 187 275 v \$0_nL-0;
#X obj 277 275 v \$0_nL-1;
#X obj 65 12 inlet;
#X obj 587 291 cml.array_name SdW;
#X msg 196 453 1.36055e-05 1.12442e-07;
#X obj 292 660 expr abs($f1 - $f2) < 1e-08;
#X connect 0 0 3 0;
#X connect 1 0 0 1;
#X connect 2 0 8 0;
#X connect 3 0 7 2;
#X connect 3 1 6 2;
#X connect 3 2 4 1;
#X connect 5 0 10 0;
#X connect 7 0 29 0;
#X connect 8 0 0 0;
#X connect 8 1 1 0;
#X connect 9 0 18 0;
#X connect 10 0 11 1;
#X connect 10 1 4 0;
#X connect 11 0 9 0;
#X connect 12 0 7 1;
#X connect 13 0 27 1;
#X connect 14 0 27 0;
#X connect 15 0 17 0;
#X connect 15 1 16 2;
#X connect 16 0 29 1;
#X connect 17 0 16 1;
#X connect 18 0 7 0;
#X connect 18 1 12 0;
#X connect 18 2 16 0;
#X connect 20 0 14 0;
#X connect 20 1 13 0;
#X connect 21 0 11 0;
#X connect 21 1 28 0;
#X connect 21 2 24 0;
#X connect 21 3 25 0;
#X connect 21 4 2 0;
#X connect 21 5 20 0;
#X connect 24 0 5 0;
#X connect 25 0 5 1;
#X connect 26 0 21 0;
#X connect 27 0 15 0;
#X connect 28 0 6 0;
#X connect 29 0 19 0;
#X restore 1260 931 pd test_Sdw_second;
#X text 706 400 // Also \, for Adam optimzation \, I'm calculating dW twice. I'll fix that now.;
#X connect 1 0 25 1;
#X connect 3 0 26 0;
#X connect 3 1 25 0;
#X connect 3 2 1 0;
#X connect 4 0 3 0;
#X connect 5 0 27 1;
#X connect 7 0 32 0;
#X connect 7 1 9 0;
#X connect 7 2 5 0;
#X connect 8 0 7 0;
#X connect 9 0 27 0;
#X connect 10 0 31 1;
#X connect 11 0 14 0;
#X connect 11 1 13 0;
#X connect 11 2 10 0;
#X connect 12 0 11 0;
#X connect 13 0 31 0;
#X connect 14 0 15 0;
#X connect 15 1 17 0;
#X connect 16 0 14 2;
#X connect 16 1 17 1;
#X connect 17 0 18 0;
#X connect 18 0 19 0;
#X connect 20 0 28 0;
#X connect 20 1 28 0;
#X connect 20 2 21 0;
#X connect 21 0 28 1;
#X connect 22 0 86 0;
#X connect 25 0 2 2;
#X connect 26 0 2 0;
#X connect 27 0 6 2;
#X connect 29 0 20 0;
#X connect 31 0 16 0;
#X connect 32 0 6 0;
#X connect 35 0 40 1;
#X connect 37 0 42 0;
#X connect 37 1 39 0;
#X connect 37 2 35 0;
#X connect 38 0 37 0;
#X connect 39 0 40 0;
#X connect 40 0 36 2;
#X connect 42 0 36 0;
#X connect 44 0 54 1;
#X connect 45 0 48 0;
#X connect 45 1 47 0;
#X connect 45 2 44 0;
#X connect 46 0 45 0;
#X connect 47 0 54 0;
#X connect 48 0 49 0;
#X connect 49 1 51 0;
#X connect 50 0 48 2;
#X connect 50 1 51 1;
#X connect 51 0 52 0;
#X connect 52 0 53 0;
#X connect 54 0 50 0;
#X connect 55 0 33 1;
#X connect 57 0 67 1;
#X connect 58 0 61 0;
#X connect 58 1 60 0;
#X connect 58 2 57 0;
#X connect 59 0 58 0;
#X connect 60 0 67 0;
#X connect 61 0 62 0;
#X connect 62 1 64 0;
#X connect 63 0 61 2;
#X connect 63 1 64 1;
#X connect 64 0 65 0;
#X connect 65 0 66 0;
#X connect 67 0 63 0;
#X connect 69 0 79 1;
#X connect 70 0 73 0;
#X connect 70 1 72 0;
#X connect 70 2 69 0;
#X connect 71 0 70 0;
#X connect 72 0 79 0;
#X connect 73 0 74 0;
#X connect 74 1 76 0;
#X connect 75 0 73 2;
#X connect 75 1 76 1;
#X connect 76 0 77 0;
#X connect 77 0 78 0;
#X connect 79 0 75 0;
#X connect 82 0 85 0;
#X connect 83 0 84 0;
#X connect 87 0 33 0;
#X connect 87 1 55 0;
#X connect 89 0 33 0;
#X connect 90 0 87 0;
#X connect 93 0 94 0;
#X connect 96 0 97 0;
#X restore 294 701 pd test_backward_linear_dw_momentum_and_rmsprop_output_layer_2_1;
#X text 304 633 // This is essentially testing Adam. There's an issue with Adam where dW gets calculated twice. Doesn't break anything \, but it's inefficient.;
#N canvas 4 70 1712 1332 test_backward_linear_dw_adam 0;
#X text 45 27 // layer 0 \, (nL-0 \, nL-1) (1 \, 2) \;;
#X obj 467 355 v \$0_ns;
#X obj 33 454 array set, f 41;
#X obj 33 322 t b b b, f 45;
#X msg 33 289 bang;
#X obj 493 564 v \$0_ns;
#X obj 35 660 array set, f 42;
#X obj 35 528 t b b b, f 49;
#X msg 35 495 bang;
#X obj 368 565 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 1772 117 v \$0_ns;
#X obj 1314 81 t b b b, f 49;
#X msg 1314 48 bang;
#X obj 1647 118 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 1314 213 array get, f 42;
#X obj 1314 241 t l l, f 35;
#X obj 1647 178 t s s;
#X obj 1591 274 list prepend;
#X obj 1591 302 list trim;
#X obj 1591 330 print values \$1;
#X obj 703 142 t b a b, f 17;
#X obj 836 172 v \$0_ns;
#X msg 1260 500 bang;
#X text 1318 15 // Inspect the results \;;
#X text 707 635 // Compare actual to expected \;;
#X obj 358 388 cml.label_name;
#X msg 33 421 0.1 0.5 0.2 0.4;
#X obj 368 597 cml.array_name A;
#X obj 703 205 cml.outer_dz;
#X msg 703 94 m 4 \, num_outputs 1;
#X text 702 58 // Trigger dZ calculation \;;
#X obj 1647 150 cml.array_name dZ;
#X msg 35 627 -0.1 -0.2 0.1 0.8, f 43;
#X obj 706 583 cml.layer_backward;
#X text 36 75 // dW = 1/m dZ^[l]A^[l-1]T \;;
#X obj 493 824 v \$0_ns;
#X obj 35 920 array set, f 42;
#X obj 35 788 t b b b, f 49;
#X msg 35 755 bang;
#X obj 368 825 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 1 256;
#X obj 368 857 cml.array_name A;
#X text 32 251 // calculate dZ/dA;
#X msg 35 887 -0.5 -0.4 -0.3 -0.2 0.1 0.2 0.3 0.4, f 43;
#X text 704 252 // dZL-0 = -0.2 -0.7 -0.1 0.4;
#X obj 2312 117 v \$0_ns;
#X obj 1854 81 t b b b, f 49;
#X msg 1854 48 bang;
#X obj 2187 118 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 1854 213 array get, f 42;
#X obj 1854 241 t l l, f 35;
#X obj 2187 178 t s s;
#X obj 2131 274 list prepend;
#X obj 2131 302 list trim;
#X obj 2131 330 print values \$1;
#X obj 2187 150 cml.array_name dW;
#X obj 847 552 v \$0_ns;
#X text 705 273 // NOTE: there's a bug where unused optimization algorithms may need to be added to the options \;;
#X obj 2312 427 v \$0_ns;
#X obj 1854 391 t b b b, f 49;
#X msg 1854 358 bang;
#X obj 2187 428 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 1854 523 array get, f 42;
#X obj 1854 551 t l l, f 35;
#X obj 2187 488 t s s;
#X obj 2131 584 list prepend;
#X obj 2131 612 list trim;
#X obj 2131 640 print values \$1;
#X obj 2187 460 cml.array_name VdW;
#X obj 2131 700 print values \$1;
#X obj 2312 797 v \$0_ns;
#X obj 1854 761 t b b b, f 49;
#X msg 1854 728 bang;
#X obj 2187 798 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 1854 893 array get, f 42;
#X obj 1854 921 t l l, f 35;
#X obj 2187 858 t s s;
#X obj 2131 954 list prepend;
#X obj 2131 982 list trim;
#X obj 2131 1010 print values \$1;
#X obj 2187 830 cml.array_name SdW;
#X text 30 99 // VdW = mu.VdW + (1 - mu)dW \;;
#X text 30 119 // SdW = rho.SdW + (1 - rho)dW^2 \;;
#X msg 1260 580 bang;
#X msg 1260 660 bang;
#N canvas 4 363 1430 1007 test_Sdw_first 0;
#X obj 361 295 cml.d0;
#X obj 406 262 v \$0_ns;
#X msg 361 201 expectations;
#X obj 361 323 t s s s;
#X obj 337 372 array size;
#X obj 187 308 *;
#X obj 196 486 array set;
#X obj 292 609 array get;
#X obj 361 229 t a b;
#X obj 65 453 cml.range;
#X obj 187 336 t f f;
#X obj 65 420 f;
#X msg 322 572 1;
#X obj 712 258 v \$0_ns;
#X obj 587 259 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 587 319 t b s;
#X obj 555 581 array get;
#X msg 588 547 1;
#X obj 65 481 t f b f;
#X obj 292 713 print values match;
#X obj 292 660 expr abs($f1 - $f2) < 1e-07;
#X obj 587 226 t b b;
#X obj 65 47 t b b b b b b, f 14;
#X text 372 425 // manually calculated \;;
#X text 540 656 // Deal with floating point differences between expected and actual \;;
#X obj 187 275 v \$0_nL-0;
#X obj 277 275 v \$0_nL-1;
#X obj 65 12 inlet;
#X msg 196 453 6.80626e-06 5.625e-08;
#X obj 587 291 cml.array_name SdW;
#X connect 0 0 3 0;
#X connect 1 0 0 1;
#X connect 2 0 8 0;
#X connect 3 0 7 2;
#X connect 3 1 6 2;
#X connect 3 2 4 1;
#X connect 5 0 10 0;
#X connect 7 0 20 0;
#X connect 8 0 0 0;
#X connect 8 1 1 0;
#X connect 9 0 18 0;
#X connect 10 0 11 1;
#X connect 10 1 4 0;
#X connect 11 0 9 0;
#X connect 12 0 7 1;
#X connect 13 0 29 1;
#X connect 14 0 29 0;
#X connect 15 0 17 0;
#X connect 15 1 16 2;
#X connect 16 0 20 1;
#X connect 17 0 16 1;
#X connect 18 0 7 0;
#X connect 18 1 12 0;
#X connect 18 2 16 0;
#X connect 20 0 19 0;
#X connect 21 0 14 0;
#X connect 21 1 13 0;
#X connect 22 0 11 0;
#X connect 22 1 28 0;
#X connect 22 2 25 0;
#X connect 22 3 26 0;
#X connect 22 4 2 0;
#X connect 22 5 21 0;
#X connect 25 0 5 0;
#X connect 26 0 5 1;
#X connect 27 0 22 0;
#X connect 28 0 6 0;
#X connect 29 0 15 0;
#X restore 1260 693 pd test_Sdw_first;
#N canvas 375 301 1430 1007 test_VdW_first 0;
#X obj 361 295 cml.d0;
#X obj 406 262 v \$0_ns;
#X msg 361 201 expectations;
#X obj 361 323 t s s s;
#X obj 337 372 array size;
#X obj 187 308 *;
#X obj 196 486 array set;
#X obj 292 609 array get;
#X obj 361 229 t a b;
#X obj 65 453 cml.range;
#X obj 187 336 t f f;
#X obj 65 420 f;
#X msg 322 572 1;
#X obj 712 258 v \$0_ns;
#X obj 587 259 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 587 319 t b s;
#X obj 555 581 array get;
#X msg 588 547 1;
#X obj 65 481 t f b f;
#X obj 292 713 print values match;
#X obj 292 660 expr abs($f1 - $f2) < 1e-07;
#X obj 587 226 t b b;
#X obj 65 47 t b b b b b b, f 14;
#X text 372 425 // manually calculated \;;
#X text 540 656 // Deal with floating point differences between expected and actual \;;
#X obj 187 275 v \$0_nL-0;
#X obj 277 275 v \$0_nL-1;
#X obj 65 12 inlet;
#X msg 196 453 0.00825 -0.00075;
#X obj 587 291 cml.array_name VdW;
#X connect 0 0 3 0;
#X connect 1 0 0 1;
#X connect 2 0 8 0;
#X connect 3 0 7 2;
#X connect 3 1 6 2;
#X connect 3 2 4 1;
#X connect 5 0 10 0;
#X connect 7 0 20 0;
#X connect 8 0 0 0;
#X connect 8 1 1 0;
#X connect 9 0 18 0;
#X connect 10 0 11 1;
#X connect 10 1 4 0;
#X connect 11 0 9 0;
#X connect 12 0 7 1;
#X connect 13 0 29 1;
#X connect 14 0 29 0;
#X connect 15 0 17 0;
#X connect 15 1 16 2;
#X connect 16 0 20 1;
#X connect 17 0 16 1;
#X connect 18 0 7 0;
#X connect 18 1 12 0;
#X connect 18 2 16 0;
#X connect 20 0 19 0;
#X connect 21 0 14 0;
#X connect 21 1 13 0;
#X connect 22 0 11 0;
#X connect 22 1 28 0;
#X connect 22 2 25 0;
#X connect 22 3 26 0;
#X connect 22 4 2 0;
#X connect 22 5 21 0;
#X connect 25 0 5 0;
#X connect 26 0 5 1;
#X connect 27 0 22 0;
#X connect 28 0 6 0;
#X connect 29 0 15 0;
#X restore 1260 613 pd test_VdW_first;
#N canvas 992 268 1430 1007 test_dW 0;
#X obj 361 295 cml.d0;
#X obj 406 262 v \$0_ns;
#X msg 361 201 expectations;
#X obj 361 323 t s s s;
#X obj 337 372 array size;
#X obj 187 308 *;
#X obj 196 486 array set;
#X obj 292 609 array get;
#X obj 361 229 t a b;
#X obj 65 453 cml.range;
#X obj 187 336 t f f;
#X obj 65 420 f;
#X msg 322 572 1;
#X obj 712 258 v \$0_ns;
#X obj 587 259 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 587 319 t b s;
#X obj 555 581 array get;
#X msg 588 547 1;
#X obj 65 481 t f b f;
#X obj 292 713 print values match;
#X obj 292 660 expr abs($f1 - $f2) < 1e-07;
#X obj 587 226 t b b;
#X obj 65 47 t b b b b b b, f 14;
#X text 372 425 // manually calculated \;;
#X text 540 656 // Deal with floating point differences between expected and actual \;;
#X obj 187 275 v \$0_nL-0;
#X obj 587 291 cml.array_name dW;
#X msg 196 453 0.0825 -0.0075;
#X obj 277 275 v \$0_nL-1;
#X obj 65 12 inlet;
#X connect 0 0 3 0;
#X connect 1 0 0 1;
#X connect 2 0 8 0;
#X connect 3 0 7 2;
#X connect 3 1 6 2;
#X connect 3 2 4 1;
#X connect 5 0 10 0;
#X connect 7 0 20 0;
#X connect 8 0 0 0;
#X connect 8 1 1 0;
#X connect 9 0 18 0;
#X connect 10 0 11 1;
#X connect 10 1 4 0;
#X connect 11 0 9 0;
#X connect 12 0 7 1;
#X connect 13 0 26 1;
#X connect 14 0 26 0;
#X connect 15 0 17 0;
#X connect 15 1 16 2;
#X connect 16 0 20 1;
#X connect 17 0 16 1;
#X connect 18 0 7 0;
#X connect 18 1 12 0;
#X connect 18 2 16 0;
#X connect 20 0 19 0;
#X connect 21 0 14 0;
#X connect 21 1 13 0;
#X connect 22 0 11 0;
#X connect 22 1 27 0;
#X connect 22 2 25 0;
#X connect 22 3 28 0;
#X connect 22 4 2 0;
#X connect 22 5 21 0;
#X connect 25 0 5 0;
#X connect 26 0 15 0;
#X connect 27 0 6 0;
#X connect 28 0 5 1;
#X connect 29 0 22 0;
#X restore 1260 533 pd test_dW;
#X obj 707 516 t a b;
#X msg 634 477 bang;
#X text 711 676 // Expected for first pass \; VdW will be 0.1 x dW \; SdW will be 0.001 x dW^2 \; dW = 0.0825 -0.0075 \; 0.0825^2 = 0.00680625 \; 0.00680625 x 0.001 = 6.80626e-06 \; -0.0075^2 = 5.625e-05 \; 5.625e-05 * 0.001 = 5.625e-08 \;;
#X text 696 843 // Expected for second pass \; VdW_current = 0.00825 -0.00075 \; dW_current = 0.0825 -0.0075 \; VdW_new[0] = 0.9 * 0.00825 + 0.1 * 0.0825 \; VdW_new[1] = 0.9 * -0.00075 + 0.1 * -0.0075 \; SdW_current = 6.80616e-06 5.62492e-08 \; SdW_new[0] = 0.999 * 6.80616e-06 + 0.001 * 0.0825^2 \; SdW_new[1] = 0.999 * 5.62492e-08 + 0.001 * -0.0075^2 \;;
#X msg 1257 813 bang;
#N canvas 1145 80 1430 1007 test_VdW_second 0;
#X obj 361 295 cml.d0;
#X obj 406 262 v \$0_ns;
#X msg 361 201 expectations;
#X obj 361 323 t s s s;
#X obj 337 372 array size;
#X obj 187 308 *;
#X obj 196 486 array set;
#X obj 292 609 array get;
#X obj 361 229 t a b;
#X obj 65 453 cml.range;
#X obj 187 336 t f f;
#X obj 65 420 f;
#X msg 322 572 1;
#X obj 712 258 v \$0_ns;
#X obj 587 259 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 587 319 t b s;
#X obj 555 581 array get;
#X msg 588 547 1;
#X obj 65 481 t f b f;
#X obj 292 713 print values match;
#X obj 292 660 expr abs($f1 - $f2) < 1e-07;
#X obj 587 226 t b b;
#X obj 65 47 t b b b b b b, f 14;
#X text 372 425 // manually calculated \;;
#X text 540 656 // Deal with floating point differences between expected and actual \;;
#X obj 187 275 v \$0_nL-0;
#X obj 277 275 v \$0_nL-1;
#X obj 65 12 inlet;
#X obj 587 291 cml.array_name VdW;
#X msg 196 453 0.015675 -0.001425;
#X connect 0 0 3 0;
#X connect 1 0 0 1;
#X connect 2 0 8 0;
#X connect 3 0 7 2;
#X connect 3 1 6 2;
#X connect 3 2 4 1;
#X connect 5 0 10 0;
#X connect 7 0 20 0;
#X connect 8 0 0 0;
#X connect 8 1 1 0;
#X connect 9 0 18 0;
#X connect 10 0 11 1;
#X connect 10 1 4 0;
#X connect 11 0 9 0;
#X connect 12 0 7 1;
#X connect 13 0 28 1;
#X connect 14 0 28 0;
#X connect 15 0 17 0;
#X connect 15 1 16 2;
#X connect 16 0 20 1;
#X connect 17 0 16 1;
#X connect 18 0 7 0;
#X connect 18 1 12 0;
#X connect 18 2 16 0;
#X connect 20 0 19 0;
#X connect 21 0 14 0;
#X connect 21 1 13 0;
#X connect 22 0 11 0;
#X connect 22 1 29 0;
#X connect 22 2 25 0;
#X connect 22 3 26 0;
#X connect 22 4 2 0;
#X connect 22 5 21 0;
#X connect 25 0 5 0;
#X connect 26 0 5 1;
#X connect 27 0 22 0;
#X connect 28 0 15 0;
#X connect 29 0 6 0;
#X restore 1257 845 pd test_VdW_second;
#X text 1254 764 // click the <-bang message again to make sure calculations update correctly.;
#X msg 1260 898 bang;
#N canvas 8 395 1430 1007 test_Sdw_second 0;
#X obj 361 295 cml.d0;
#X obj 406 262 v \$0_ns;
#X msg 361 201 expectations;
#X obj 361 323 t s s s;
#X obj 337 372 array size;
#X obj 187 308 *;
#X obj 196 486 array set;
#X obj 292 609 array get;
#X obj 361 229 t a b;
#X obj 65 453 cml.range;
#X obj 187 336 t f f;
#X obj 65 420 f;
#X msg 322 572 1;
#X obj 712 258 v \$0_ns;
#X obj 587 259 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 587 319 t b s;
#X obj 555 581 array get;
#X msg 588 547 1;
#X obj 65 481 t f b f;
#X obj 292 713 print values match;
#X obj 587 226 t b b;
#X obj 65 47 t b b b b b b, f 14;
#X text 372 425 // manually calculated \;;
#X text 540 656 // Deal with floating point differences between expected and actual \;;
#X obj 187 275 v \$0_nL-0;
#X obj 277 275 v \$0_nL-1;
#X obj 65 12 inlet;
#X obj 587 291 cml.array_name SdW;
#X msg 196 453 1.36055e-05 1.12442e-07;
#X obj 292 660 expr abs($f1 - $f2) < 1e-08;
#X connect 0 0 3 0;
#X connect 1 0 0 1;
#X connect 2 0 8 0;
#X connect 3 0 7 2;
#X connect 3 1 6 2;
#X connect 3 2 4 1;
#X connect 5 0 10 0;
#X connect 7 0 29 0;
#X connect 8 0 0 0;
#X connect 8 1 1 0;
#X connect 9 0 18 0;
#X connect 10 0 11 1;
#X connect 10 1 4 0;
#X connect 11 0 9 0;
#X connect 12 0 7 1;
#X connect 13 0 27 1;
#X connect 14 0 27 0;
#X connect 15 0 17 0;
#X connect 15 1 16 2;
#X connect 16 0 29 1;
#X connect 17 0 16 1;
#X connect 18 0 7 0;
#X connect 18 1 12 0;
#X connect 18 2 16 0;
#X connect 20 0 14 0;
#X connect 20 1 13 0;
#X connect 21 0 11 0;
#X connect 21 1 28 0;
#X connect 21 2 24 0;
#X connect 21 3 25 0;
#X connect 21 4 2 0;
#X connect 21 5 20 0;
#X connect 24 0 5 0;
#X connect 25 0 5 1;
#X connect 26 0 21 0;
#X connect 27 0 15 0;
#X connect 28 0 6 0;
#X connect 29 0 19 0;
#X restore 1260 931 pd test_Sdw_second;
#X msg 707 430 layer_number 0 \, layer_dims 1 2 \, m 4 \, activation linear \, skip_dz 1 \, gd 0 \, momentum 0 \, rmsprop 0 \, adam 1 \, mu 0.9 \, rho 0.999;
#X text 40 157 // Testing Adam. Otherwise the same as momentum-rmsprop test \;;
#X connect 1 0 25 1;
#X connect 3 0 26 0;
#X connect 3 1 25 0;
#X connect 3 2 1 0;
#X connect 4 0 3 0;
#X connect 5 0 27 1;
#X connect 7 0 32 0;
#X connect 7 1 9 0;
#X connect 7 2 5 0;
#X connect 8 0 7 0;
#X connect 9 0 27 0;
#X connect 10 0 31 1;
#X connect 11 0 14 0;
#X connect 11 1 13 0;
#X connect 11 2 10 0;
#X connect 12 0 11 0;
#X connect 13 0 31 0;
#X connect 14 0 15 0;
#X connect 15 1 17 0;
#X connect 16 0 14 2;
#X connect 16 1 17 1;
#X connect 17 0 18 0;
#X connect 18 0 19 0;
#X connect 20 0 28 0;
#X connect 20 1 28 0;
#X connect 20 2 21 0;
#X connect 21 0 28 1;
#X connect 22 0 86 0;
#X connect 25 0 2 2;
#X connect 26 0 2 0;
#X connect 27 0 6 2;
#X connect 29 0 20 0;
#X connect 31 0 16 0;
#X connect 32 0 6 0;
#X connect 35 0 40 1;
#X connect 37 0 42 0;
#X connect 37 1 39 0;
#X connect 37 2 35 0;
#X connect 38 0 37 0;
#X connect 39 0 40 0;
#X connect 40 0 36 2;
#X connect 42 0 36 0;
#X connect 44 0 54 1;
#X connect 45 0 48 0;
#X connect 45 1 47 0;
#X connect 45 2 44 0;
#X connect 46 0 45 0;
#X connect 47 0 54 0;
#X connect 48 0 49 0;
#X connect 49 1 51 0;
#X connect 50 0 48 2;
#X connect 50 1 51 1;
#X connect 51 0 52 0;
#X connect 52 0 53 0;
#X connect 54 0 50 0;
#X connect 55 0 33 1;
#X connect 57 0 67 1;
#X connect 58 0 61 0;
#X connect 58 1 60 0;
#X connect 58 2 57 0;
#X connect 59 0 58 0;
#X connect 60 0 67 0;
#X connect 61 0 62 0;
#X connect 62 1 64 0;
#X connect 63 0 61 2;
#X connect 63 1 64 1;
#X connect 64 0 65 0;
#X connect 65 0 66 0;
#X connect 67 0 63 0;
#X connect 69 0 79 1;
#X connect 70 0 73 0;
#X connect 70 1 72 0;
#X connect 70 2 69 0;
#X connect 71 0 70 0;
#X connect 72 0 79 0;
#X connect 73 0 74 0;
#X connect 74 1 76 0;
#X connect 75 0 73 2;
#X connect 75 1 76 1;
#X connect 76 0 77 0;
#X connect 77 0 78 0;
#X connect 79 0 75 0;
#X connect 82 0 85 0;
#X connect 83 0 84 0;
#X connect 87 0 33 0;
#X connect 87 1 55 0;
#X connect 88 0 33 0;
#X connect 91 0 92 0;
#X connect 94 0 95 0;
#X connect 96 0 87 0;
#X restore 294 811 pd test_backward_linear_dw_adam;
#X text 302 783 // Testing the fix for the Adam issue;
#N canvas 153 70 1712 1332 test_backward_linear_db_adam 0;
#X text 45 27 // layer 0 \, (nL-0 \, nL-1) (1 \, 2) \;;
#X obj 467 355 v \$0_ns;
#X obj 33 454 array set, f 41;
#X obj 33 322 t b b b, f 45;
#X msg 33 289 bang;
#X obj 493 564 v \$0_ns;
#X obj 35 660 array set, f 42;
#X obj 35 528 t b b b, f 49;
#X msg 35 495 bang;
#X obj 368 565 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 1772 117 v \$0_ns;
#X obj 1314 81 t b b b, f 49;
#X msg 1314 48 bang;
#X obj 1647 118 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 1314 213 array get, f 42;
#X obj 1314 241 t l l, f 35;
#X obj 1647 178 t s s;
#X obj 1591 274 list prepend;
#X obj 1591 302 list trim;
#X obj 1591 330 print values \$1;
#X obj 703 142 t b a b, f 17;
#X obj 836 172 v \$0_ns;
#X msg 1260 500 bang;
#X text 1318 15 // Inspect the results \;;
#X text 707 635 // Compare actual to expected \;;
#X obj 358 388 cml.label_name;
#X msg 33 421 0.1 0.5 0.2 0.4;
#X obj 368 597 cml.array_name A;
#X obj 703 205 cml.outer_dz;
#X msg 703 94 m 4 \, num_outputs 1;
#X text 702 58 // Trigger dZ calculation \;;
#X obj 1647 150 cml.array_name dZ;
#X msg 35 627 -0.1 -0.2 0.1 0.8, f 43;
#X obj 706 583 cml.layer_backward;
#X obj 493 824 v \$0_ns;
#X obj 35 920 array set, f 42;
#X obj 35 788 t b b b, f 49;
#X msg 35 755 bang;
#X obj 368 825 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 1 256;
#X obj 368 857 cml.array_name A;
#X text 32 251 // calculate dZ/dA;
#X msg 35 887 -0.5 -0.4 -0.3 -0.2 0.1 0.2 0.3 0.4, f 43;
#X text 704 252 // dZL-0 = -0.2 -0.7 -0.1 0.4;
#X obj 2312 117 v \$0_ns;
#X obj 1854 81 t b b b, f 49;
#X msg 1854 48 bang;
#X obj 2187 118 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 1854 213 array get, f 42;
#X obj 1854 241 t l l, f 35;
#X obj 2187 178 t s s;
#X obj 2131 274 list prepend;
#X obj 2131 302 list trim;
#X obj 2131 330 print values \$1;
#X obj 847 552 v \$0_ns;
#X text 705 273 // NOTE: there's a bug where unused optimization algorithms may need to be added to the options \;;
#X obj 2312 427 v \$0_ns;
#X obj 1854 391 t b b b, f 49;
#X msg 1854 358 bang;
#X obj 2187 428 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 1854 523 array get, f 42;
#X obj 1854 551 t l l, f 35;
#X obj 2187 488 t s s;
#X obj 2131 584 list prepend;
#X obj 2131 612 list trim;
#X obj 2131 640 print values \$1;
#X obj 2131 700 print values \$1;
#X obj 2312 797 v \$0_ns;
#X obj 1854 761 t b b b, f 49;
#X msg 1854 728 bang;
#X obj 2187 798 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 1854 893 array get, f 42;
#X obj 1854 921 t l l, f 35;
#X obj 2187 858 t s s;
#X obj 2131 954 list prepend;
#X obj 2131 982 list trim;
#X obj 2131 1010 print values \$1;
#X msg 1260 580 bang;
#X msg 1260 660 bang;
#X obj 707 516 t a b;
#X msg 634 477 bang;
#X msg 1257 813 bang;
#X text 1254 764 // click the <-bang message again to make sure calculations update correctly.;
#X msg 1260 898 bang;
#N canvas 407 252 1430 1007 test_Sdw_second 0;
#X obj 361 295 cml.d0;
#X obj 406 262 v \$0_ns;
#X msg 361 201 expectations;
#X obj 361 323 t s s s;
#X obj 337 372 array size;
#X obj 196 486 array set;
#X obj 292 609 array get;
#X obj 361 229 t a b;
#X obj 65 453 cml.range;
#X obj 187 336 t f f;
#X obj 65 420 f;
#X msg 322 572 1;
#X obj 712 258 v \$0_ns;
#X obj 587 259 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 587 319 t b s;
#X obj 555 581 array get;
#X msg 588 547 1;
#X obj 65 481 t f b f;
#X obj 292 713 print values match;
#X obj 587 226 t b b;
#X obj 65 47 t b b b b b b, f 14;
#X text 372 425 // manually calculated \;;
#X text 540 656 // Deal with floating point differences between expected and actual \;;
#X obj 187 275 v \$0_nL-0;
#X obj 65 12 inlet;
#X obj 292 660 expr abs($f1 - $f2) < 1e-08;
#X obj 587 291 cml.array_name Sdb;
#X msg 196 453 4.49769e-05;
#X connect 0 0 3 0;
#X connect 1 0 0 1;
#X connect 2 0 7 0;
#X connect 3 0 6 2;
#X connect 3 1 5 2;
#X connect 3 2 4 1;
#X connect 6 0 25 0;
#X connect 7 0 0 0;
#X connect 7 1 1 0;
#X connect 8 0 17 0;
#X connect 9 0 10 1;
#X connect 9 1 4 0;
#X connect 10 0 8 0;
#X connect 11 0 6 1;
#X connect 12 0 26 1;
#X connect 13 0 26 0;
#X connect 14 0 16 0;
#X connect 14 1 15 2;
#X connect 15 0 25 1;
#X connect 16 0 15 1;
#X connect 17 0 6 0;
#X connect 17 1 11 0;
#X connect 17 2 15 0;
#X connect 19 0 13 0;
#X connect 19 1 12 0;
#X connect 20 0 10 0;
#X connect 20 1 27 0;
#X connect 20 2 23 0;
#X connect 20 4 2 0;
#X connect 20 5 19 0;
#X connect 23 0 9 0;
#X connect 24 0 20 0;
#X connect 25 0 18 0;
#X connect 26 0 14 0;
#X connect 27 0 5 0;
#X restore 1260 931 pd test_Sdw_second;
#X msg 707 430 layer_number 0 \, layer_dims 1 2 \, m 4 \, activation linear \, skip_dz 1 \, gd 0 \, momentum 0 \, rmsprop 0 \, adam 1 \, mu 0.9 \, rho 0.999;
#X text 40 157 // Testing Adam. Otherwise the same as momentum-rmsprop test \;;
#X text 36 75 // db = 1/m sum(dZ) \;;
#X text 30 99 // Vdn = mu.Vdb + (1 - mu)db \;;
#X text 30 119 // Sdb = rho.Sdb + (1 - rho)db^2 \;;
#X obj 2187 150 cml.array_name db;
#X obj 2187 460 cml.array_name Vdb;
#X obj 2187 830 cml.array_name Sdb;
#X text 711 676 // Expected for first pass \; Vdb will be 0.1 x db \; db = -0.15 \; Vdb_initial = -0.015 Sdb will be 0.001 x db^2 \; db = -0.15 \; -0.15^2 = 0.0225 \; 0.00225 x 0.001 = (approx)2.25e-05 \;;
#N canvas 1470 326 1430 1007 test_db 0;
#X obj 361 295 cml.d0;
#X obj 406 262 v \$0_ns;
#X msg 361 201 expectations;
#X obj 361 323 t s s s;
#X obj 337 372 array size;
#X obj 196 486 array set;
#X obj 292 609 array get;
#X obj 361 229 t a b;
#X obj 65 453 cml.range;
#X obj 187 336 t f f;
#X obj 65 420 f;
#X msg 322 572 1;
#X obj 712 258 v \$0_ns;
#X obj 587 259 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 587 319 t b s;
#X obj 555 581 array get;
#X msg 588 547 1;
#X obj 65 481 t f b f;
#X obj 292 713 print values match;
#X obj 292 660 expr abs($f1 - $f2) < 1e-07;
#X obj 587 226 t b b;
#X obj 65 47 t b b b b b b, f 14;
#X text 372 425 // manually calculated \;;
#X text 540 656 // Deal with floating point differences between expected and actual \;;
#X obj 187 275 v \$0_nL-0;
#X obj 65 12 inlet;
#X msg 196 453 -0.15;
#X obj 587 291 cml.array_name db;
#X connect 0 0 3 0;
#X connect 1 0 0 1;
#X connect 2 0 7 0;
#X connect 3 0 6 2;
#X connect 3 1 5 2;
#X connect 3 2 4 1;
#X connect 6 0 19 0;
#X connect 7 0 0 0;
#X connect 7 1 1 0;
#X connect 8 0 17 0;
#X connect 9 0 10 1;
#X connect 9 1 4 0;
#X connect 10 0 8 0;
#X connect 11 0 6 1;
#X connect 12 0 27 1;
#X connect 13 0 27 0;
#X connect 14 0 16 0;
#X connect 14 1 15 2;
#X connect 15 0 19 1;
#X connect 16 0 15 1;
#X connect 17 0 6 0;
#X connect 17 1 11 0;
#X connect 17 2 15 0;
#X connect 19 0 18 0;
#X connect 20 0 13 0;
#X connect 20 1 12 0;
#X connect 21 0 10 0;
#X connect 21 1 26 0;
#X connect 21 2 24 0;
#X connect 21 4 2 0;
#X connect 21 5 20 0;
#X connect 24 0 9 0;
#X connect 25 0 21 0;
#X connect 26 0 5 0;
#X connect 27 0 14 0;
#X restore 1260 533 pd test_db;
#N canvas 1353 269 1430 1007 test_Vdb_first 0;
#X obj 361 295 cml.d0;
#X obj 406 262 v \$0_ns;
#X msg 361 201 expectations;
#X obj 361 323 t s s s;
#X obj 337 372 array size;
#X obj 196 486 array set;
#X obj 292 609 array get;
#X obj 361 229 t a b;
#X obj 65 453 cml.range;
#X obj 187 336 t f f;
#X obj 65 420 f;
#X msg 322 572 1;
#X obj 712 258 v \$0_ns;
#X obj 587 259 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 587 319 t b s;
#X obj 555 581 array get;
#X msg 588 547 1;
#X obj 65 481 t f b f;
#X obj 292 713 print values match;
#X obj 292 660 expr abs($f1 - $f2) < 1e-07;
#X obj 587 226 t b b;
#X obj 65 47 t b b b b b b, f 14;
#X text 372 425 // manually calculated \;;
#X text 540 656 // Deal with floating point differences between expected and actual \;;
#X obj 187 275 v \$0_nL-0;
#X obj 65 12 inlet;
#X obj 587 291 cml.array_name Vdb;
#X msg 197 453 -0.015;
#X connect 0 0 3 0;
#X connect 1 0 0 1;
#X connect 2 0 7 0;
#X connect 3 0 6 2;
#X connect 3 1 5 2;
#X connect 3 2 4 1;
#X connect 6 0 19 0;
#X connect 7 0 0 0;
#X connect 7 1 1 0;
#X connect 8 0 17 0;
#X connect 9 0 10 1;
#X connect 9 1 4 0;
#X connect 10 0 8 0;
#X connect 11 0 6 1;
#X connect 12 0 26 1;
#X connect 13 0 26 0;
#X connect 14 0 16 0;
#X connect 14 1 15 2;
#X connect 15 0 19 1;
#X connect 16 0 15 1;
#X connect 17 0 6 0;
#X connect 17 1 11 0;
#X connect 17 2 15 0;
#X connect 19 0 18 0;
#X connect 20 0 13 0;
#X connect 20 1 12 0;
#X connect 21 0 10 0;
#X connect 21 1 27 0;
#X connect 21 2 24 0;
#X connect 21 4 2 0;
#X connect 21 5 20 0;
#X connect 24 0 9 0;
#X connect 25 0 21 0;
#X connect 26 0 14 0;
#X connect 27 0 5 0;
#X restore 1260 613 pd test_Vdb_first;
#N canvas 783 221 1430 1007 test_Sdb_first 0;
#X obj 361 295 cml.d0;
#X obj 406 262 v \$0_ns;
#X msg 361 201 expectations;
#X obj 361 323 t s s s;
#X obj 337 372 array size;
#X obj 196 486 array set;
#X obj 292 609 array get;
#X obj 361 229 t a b;
#X obj 65 453 cml.range;
#X obj 187 336 t f f;
#X obj 65 420 f;
#X msg 322 572 1;
#X obj 712 258 v \$0_ns;
#X obj 587 259 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 587 319 t b s;
#X obj 555 581 array get;
#X msg 588 547 1;
#X obj 65 481 t f b f;
#X obj 292 713 print values match;
#X obj 292 660 expr abs($f1 - $f2) < 1e-07;
#X obj 587 226 t b b;
#X obj 65 47 t b b b b b b, f 14;
#X text 372 425 // manually calculated \;;
#X text 540 656 // Deal with floating point differences between expected and actual \;;
#X obj 187 275 v \$0_nL-0;
#X obj 65 12 inlet;
#X obj 587 291 cml.array_name Sdb;
#X msg 196 453 2.24997e-05;
#X connect 0 0 3 0;
#X connect 1 0 0 1;
#X connect 2 0 7 0;
#X connect 3 0 6 2;
#X connect 3 1 5 2;
#X connect 3 2 4 1;
#X connect 6 0 19 0;
#X connect 7 0 0 0;
#X connect 7 1 1 0;
#X connect 8 0 17 0;
#X connect 9 0 10 1;
#X connect 9 1 4 0;
#X connect 10 0 8 0;
#X connect 11 0 6 1;
#X connect 12 0 26 1;
#X connect 13 0 26 0;
#X connect 14 0 16 0;
#X connect 14 1 15 2;
#X connect 15 0 19 1;
#X connect 16 0 15 1;
#X connect 17 0 6 0;
#X connect 17 1 11 0;
#X connect 17 2 15 0;
#X connect 19 0 18 0;
#X connect 20 0 13 0;
#X connect 20 1 12 0;
#X connect 21 0 10 0;
#X connect 21 1 27 0;
#X connect 21 2 24 0;
#X connect 21 4 2 0;
#X connect 21 5 20 0;
#X connect 24 0 9 0;
#X connect 25 0 21 0;
#X connect 26 0 14 0;
#X connect 27 0 5 0;
#X restore 1260 693 pd test_Sdb_first;
#X text 715 874 // Expected for second pass \; db_current = -0.15 \; Vdb_initial = -0.015 \; Vdb_updated = 0.9 * -0.015 + 0.1 * -0.15 \; Sdb_updated = 0.999 * 2.24997e-05 + 0.001 * -0.15^2 \;;
#N canvas 442 207 1430 1007 test_Vdb_second 0;
#X obj 361 295 cml.d0;
#X obj 406 262 v \$0_ns;
#X msg 361 201 expectations;
#X obj 361 323 t s s s;
#X obj 337 372 array size;
#X obj 196 486 array set;
#X obj 292 609 array get;
#X obj 361 229 t a b;
#X obj 65 453 cml.range;
#X obj 187 336 t f f;
#X obj 65 420 f;
#X msg 322 572 1;
#X obj 712 258 v \$0_ns;
#X obj 587 259 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 0 256;
#X obj 587 319 t b s;
#X obj 555 581 array get;
#X msg 588 547 1;
#X obj 65 481 t f b f;
#X obj 292 713 print values match;
#X obj 292 660 expr abs($f1 - $f2) < 1e-07;
#X obj 587 226 t b b;
#X obj 65 47 t b b b b b b, f 14;
#X text 372 425 // manually calculated \;;
#X text 540 656 // Deal with floating point differences between expected and actual \;;
#X obj 187 275 v \$0_nL-0;
#X obj 65 12 inlet;
#X obj 587 291 cml.array_name Vdb;
#X msg 196 453 -0.0285;
#X connect 0 0 3 0;
#X connect 1 0 0 1;
#X connect 2 0 7 0;
#X connect 3 0 6 2;
#X connect 3 1 5 2;
#X connect 3 2 4 1;
#X connect 6 0 19 0;
#X connect 7 0 0 0;
#X connect 7 1 1 0;
#X connect 8 0 17 0;
#X connect 9 0 10 1;
#X connect 9 1 4 0;
#X connect 10 0 8 0;
#X connect 11 0 6 1;
#X connect 12 0 26 1;
#X connect 13 0 26 0;
#X connect 14 0 16 0;
#X connect 14 1 15 2;
#X connect 15 0 19 1;
#X connect 16 0 15 1;
#X connect 17 0 6 0;
#X connect 17 1 11 0;
#X connect 17 2 15 0;
#X connect 19 0 18 0;
#X connect 20 0 13 0;
#X connect 20 1 12 0;
#X connect 21 0 10 0;
#X connect 21 1 27 0;
#X connect 21 2 24 0;
#X connect 21 4 2 0;
#X connect 21 5 20 0;
#X connect 24 0 9 0;
#X connect 25 0 21 0;
#X connect 26 0 14 0;
#X connect 27 0 5 0;
#X restore 1258 845 pd test_Vdb_second;
#X connect 1 0 25 1;
#X connect 3 0 26 0;
#X connect 3 1 25 0;
#X connect 3 2 1 0;
#X connect 4 0 3 0;
#X connect 5 0 27 1;
#X connect 7 0 32 0;
#X connect 7 1 9 0;
#X connect 7 2 5 0;
#X connect 8 0 7 0;
#X connect 9 0 27 0;
#X connect 10 0 31 1;
#X connect 11 0 14 0;
#X connect 11 1 13 0;
#X connect 11 2 10 0;
#X connect 12 0 11 0;
#X connect 13 0 31 0;
#X connect 14 0 15 0;
#X connect 15 1 17 0;
#X connect 16 0 14 2;
#X connect 16 1 17 1;
#X connect 17 0 18 0;
#X connect 18 0 19 0;
#X connect 20 0 28 0;
#X connect 20 1 28 0;
#X connect 20 2 21 0;
#X connect 21 0 28 1;
#X connect 22 0 93 0;
#X connect 25 0 2 2;
#X connect 26 0 2 0;
#X connect 27 0 6 2;
#X connect 29 0 20 0;
#X connect 31 0 16 0;
#X connect 32 0 6 0;
#X connect 34 0 39 1;
#X connect 36 0 41 0;
#X connect 36 1 38 0;
#X connect 36 2 34 0;
#X connect 37 0 36 0;
#X connect 38 0 39 0;
#X connect 39 0 35 2;
#X connect 41 0 35 0;
#X connect 43 0 89 1;
#X connect 44 0 47 0;
#X connect 44 1 46 0;
#X connect 44 2 43 0;
#X connect 45 0 44 0;
#X connect 46 0 89 0;
#X connect 47 0 48 0;
#X connect 48 1 50 0;
#X connect 49 0 47 2;
#X connect 49 1 50 1;
#X connect 50 0 51 0;
#X connect 51 0 52 0;
#X connect 53 0 33 1;
#X connect 55 0 90 1;
#X connect 56 0 59 0;
#X connect 56 1 58 0;
#X connect 56 2 55 0;
#X connect 57 0 56 0;
#X connect 58 0 90 0;
#X connect 59 0 60 0;
#X connect 60 1 62 0;
#X connect 61 0 59 2;
#X connect 61 1 62 1;
#X connect 62 0 63 0;
#X connect 63 0 64 0;
#X connect 66 0 91 1;
#X connect 67 0 70 0;
#X connect 67 1 69 0;
#X connect 67 2 66 0;
#X connect 68 0 67 0;
#X connect 69 0 91 0;
#X connect 70 0 71 0;
#X connect 71 1 73 0;
#X connect 72 0 70 2;
#X connect 72 1 73 1;
#X connect 73 0 74 0;
#X connect 74 0 75 0;
#X connect 76 0 94 0;
#X connect 77 0 95 0;
#X connect 78 0 33 0;
#X connect 78 1 53 0;
#X connect 79 0 33 0;
#X connect 80 0 97 0;
#X connect 82 0 83 0;
#X connect 84 0 78 0;
#X connect 89 0 49 0;
#X connect 90 0 61 0;
#X connect 91 0 72 0;
#X restore 294 871 pd test_backward_linear_db_adam;
#N canvas 0 66 3440 1340 test_dz 1;
#X obj 2118 507 v \$0_ns;
#X obj 1652 603 array set, f 42;
#X obj 1652 471 t b b b, f 49;
#X msg 1652 438 bang;
#X obj 1985 508 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 1 256;
#X obj 1973 107 v \$0_ns;
#X obj 1515 71 t b b b, f 49;
#X msg 1515 38 bang;
#X obj 1848 108 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 1 256;
#X obj 1515 203 array get, f 42;
#X obj 1515 231 t l l, f 35;
#X obj 1848 168 t s s;
#X obj 1792 264 list prepend;
#X obj 1792 292 list trim;
#X obj 1792 320 print values \$1;
#X msg 995 304 bang;
#X text 1519 5 // Inspect the results \;;
#X obj 988 176 cml.layer_backward;
#X obj 1129 145 v \$0_ns;
#X obj 988 109 t a b;
#X msg 915 70 bang;
#X text 40 54 // dZ^[l] = dA^[l] x g^[l]'(Z^[l]) \;;
#X obj 1985 540 cml.array_name dA;
#X text 45 26 // layer 1 \, (nL-1 \, nL-2) (2 \, 2) \, m = 4 \;;
#X obj 490 233 v \$0_ns;
#X obj 32 329 array set, f 42;
#X obj 32 197 t b b b, f 49;
#X msg 32 164 bang;
#X obj 365 234 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 1 256;
#X obj 365 266 cml.array_name Z;
#X msg 32 296 0.1 -0.1 0.2 -0.2 0.3 -0.3 0.4 -0.4, f 43;
#X obj 236 514 v \$0_ns;
#X obj 111 515 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 1 256;
#X obj 111 547 cml.array_name Z;
#X obj 34 620 array size;
#X obj 95 724 array get;
#X obj 111 575 t s b s;
#X msg 130 674 1;
#X obj 34 648 cml.range;
#X obj 436 513 v \$0_ns;
#X obj 311 514 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 1 256;
#X obj 311 546 cml.array_name A;
#X obj 95 831 array set, f 14;
#X obj 95 776 expr tanh($f1);
#X msg 34 396 bang;
#X obj 34 424 t b b b b b, f 42;
#X obj 34 676 t f f;
#X msg 1652 570 0.9 0.8 0.7 0.6 -0.2 -0.1 0.1 0.2, f 43;
#X msg 988 23 layer_number 1 \, layer_dims 2 2 \, m 4 \, activation tanh \, gd 1;
#N canvas 1359 323 1430 1007 test_dz_tanh 0;
#X obj 604 694 print values match;
#X text 852 637 // Deal with floating point differences between expected and actual \;;
#X obj 381 50 inlet;
#X obj 590 219 v \$0_ns;
#X obj 457 220 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 1 256;
#X obj 380 325 array size;
#X obj 441 509 array get;
#X obj 457 280 t s b s;
#X msg 475 476 1;
#X obj 380 353 cml.range;
#X obj 782 218 v \$0_ns;
#X obj 657 219 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 1 256;
#X obj 625 506 array get;
#X obj 1012 218 v \$0_ns;
#X obj 887 219 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 1 256;
#X obj 887 251 cml.array_name dZ;
#X obj 855 499 array get;
#X msg 659 473 1;
#X obj 657 279 t b s;
#X obj 887 279 t b s;
#X msg 889 466 1;
#X obj 380 381 t f f f;
#X obj 604 602 *;
#X obj 441 537 expr 1 - pow($f1 \, 2);
#X obj 381 128 t b b b b b b b, f 58;
#X obj 604 641 expr abs($f1 - $f2) < 1e-08;
#X obj 457 252 cml.array_name A;
#X obj 657 251 cml.array_name dA;
#X text 74 18 // tanh activation: dZ = dA x (1 - A^2);
#X connect 2 0 24 0;
#X connect 3 0 26 1;
#X connect 4 0 26 0;
#X connect 5 0 9 0;
#X connect 6 0 23 0;
#X connect 7 0 5 1;
#X connect 7 1 8 0;
#X connect 7 2 6 2;
#X connect 8 0 6 1;
#X connect 9 0 21 0;
#X connect 10 0 27 1;
#X connect 11 0 27 0;
#X connect 12 0 22 1;
#X connect 13 0 15 1;
#X connect 14 0 15 0;
#X connect 15 0 19 0;
#X connect 16 0 25 1;
#X connect 17 0 12 1;
#X connect 18 0 17 0;
#X connect 18 1 12 2;
#X connect 19 0 20 0;
#X connect 19 1 16 2;
#X connect 20 0 16 1;
#X connect 21 0 6 0;
#X connect 21 1 12 0;
#X connect 21 2 16 0;
#X connect 22 0 25 0;
#X connect 23 0 22 0;
#X connect 24 0 5 0;
#X connect 24 1 4 0;
#X connect 24 2 3 0;
#X connect 24 3 11 0;
#X connect 24 4 10 0;
#X connect 24 5 14 0;
#X connect 24 6 13 0;
#X connect 25 0 0 0;
#X connect 26 0 7 0;
#X connect 27 0 18 0;
#X restore 995 336 pd test_dz_tanh;
#X msg 578 26 bang;
#X obj 578 54 s \$0_reset_for_tests;
#X text 34 131 // set Z;
#X text 35 366 // set A based on tanh(Z) \;;
#X text 1652 401 // make up a value for dA;
#X text 988 228 // compare actual to expected \;;
#X text 990 271 // tanh activation \, dZ should be dA x (1 - A^2);
#X text 46 1138 // run test_dz_tanh \, then reset:;
#X msg 67 1167 bang;
#X obj 67 1195 s \$0_reset_for_tests;
#X obj 1429 498 v \$0_ns;
#X obj 971 594 array set, f 42;
#X obj 971 462 t b b b, f 49;
#X msg 971 429 bang;
#X obj 1304 499 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 1 256;
#X obj 1304 531 cml.array_name Z;
#X msg 971 561 0.1 -0.1 0.2 -0.2 0.3 -0.3 0.4 -0.4, f 43;
#X obj 1175 779 v \$0_ns;
#X obj 1050 780 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 1 256;
#X obj 1050 812 cml.array_name Z;
#X obj 973 885 array size;
#X obj 1034 989 array get;
#X obj 1050 840 t s b s;
#X msg 1069 939 1;
#X obj 973 913 cml.range;
#X obj 1375 778 v \$0_ns;
#X obj 1250 779 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 1 256;
#X obj 1250 811 cml.array_name A;
#X obj 1034 1096 array set, f 14;
#X msg 973 661 bang;
#X obj 973 689 t b b b b b, f 42;
#X obj 973 941 t f f;
#X text 973 396 // reset Z;
#X text 974 631 // set A based on ReLU(Z) with leak 0.02 \;;
#X msg 1648 964 bang;
#X obj 1034 1041 expr max(0.02 * $f1 \, $f1);
#X text 1648 665 // ReLU activation function should be dA if z > 0.02 \, dA x 0.02 if z <= 0.2 \; this follows from g'(z) = 1 if > 0 \, leak if < 0 \;;
#X obj 1648 916 cml.layer_backward;
#X obj 1789 885 v \$0_ns;
#X obj 1648 849 t a b;
#X msg 1575 810 bang;
#X msg 1648 763 layer_number 1 \, layer_dims 2 2 \, m 4 \, activation relu \, leak 0.02 \, gd 1;
#N canvas 1383 395 1430 1007 test_dz_relu 0;
#X obj 604 694 print values match;
#X text 852 637 // Deal with floating point differences between expected and actual \;;
#X obj 381 50 inlet;
#X obj 590 219 v \$0_ns;
#X obj 457 220 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 1 256;
#X obj 380 325 array size;
#X obj 441 509 array get;
#X obj 457 280 t s b s;
#X msg 475 476 1;
#X obj 380 353 cml.range;
#X obj 782 218 v \$0_ns;
#X obj 657 219 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 1 256;
#X obj 625 506 array get;
#X obj 1012 218 v \$0_ns;
#X obj 887 219 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 1 256;
#X obj 887 251 cml.array_name dZ;
#X obj 855 499 array get;
#X msg 659 473 1;
#X obj 657 279 t b s;
#X obj 887 279 t b s;
#X msg 889 466 1;
#X obj 380 381 t f f f;
#X obj 604 602 *;
#X obj 381 128 t b b b b b b b, f 58;
#X obj 604 641 expr abs($f1 - $f2) < 1e-08;
#X obj 657 251 cml.array_name dA;
#X obj 457 252 cml.array_name Z;
#X text 678 538 // leak = 0.02 \;;
#X text 74 18 relu activation: \; dZ = dA x 1 if Z > 0 \; dZ = dA x leak if Z < 0 \;;
#X obj 441 537 expr if($f1 > 0 \, 1 \, 0.02);
#X connect 2 0 23 0;
#X connect 3 0 26 1;
#X connect 4 0 26 0;
#X connect 5 0 9 0;
#X connect 6 0 29 0;
#X connect 7 0 5 1;
#X connect 7 1 8 0;
#X connect 7 2 6 2;
#X connect 8 0 6 1;
#X connect 9 0 21 0;
#X connect 10 0 25 1;
#X connect 11 0 25 0;
#X connect 12 0 22 1;
#X connect 13 0 15 1;
#X connect 14 0 15 0;
#X connect 15 0 19 0;
#X connect 16 0 24 1;
#X connect 17 0 12 1;
#X connect 18 0 17 0;
#X connect 18 1 12 2;
#X connect 19 0 20 0;
#X connect 19 1 16 2;
#X connect 20 0 16 1;
#X connect 21 0 6 0;
#X connect 21 1 12 0;
#X connect 21 2 16 0;
#X connect 22 0 24 0;
#X connect 23 0 5 0;
#X connect 23 1 4 0;
#X connect 23 2 3 0;
#X connect 23 3 11 0;
#X connect 23 4 10 0;
#X connect 23 5 14 0;
#X connect 23 6 13 0;
#X connect 24 0 0 0;
#X connect 25 0 18 0;
#X connect 26 0 7 0;
#X connect 29 0 22 0;
#X restore 1648 996 pd test_dz_relu;
#X obj 495 970 v \$0_ns;
#X obj 29 1066 array set, f 42;
#X obj 29 934 t b b b, f 49;
#X msg 29 901 bang;
#X obj 362 971 nbx 5 21 -1e+37 1e+37 0 1 empty empty empty 0 -12 0 16 #fcfcfc #000000 #000000 1 256;
#X obj 362 1003 cml.array_name dA;
#X msg 29 1033 0.9 0.8 0.7 0.6 -0.2 -0.1 0.1 0.2, f 43;
#X text 29 864 // make up a value for dA;
#X obj 1848 140 cml.array_name dZ;
#X connect 0 0 22 1;
#X connect 2 0 47 0;
#X connect 2 1 4 0;
#X connect 2 2 0 0;
#X connect 3 0 2 0;
#X connect 4 0 22 0;
#X connect 5 0 101 1;
#X connect 6 0 9 0;
#X connect 6 1 8 0;
#X connect 6 2 5 0;
#X connect 7 0 6 0;
#X connect 8 0 101 0;
#X connect 9 0 10 0;
#X connect 10 1 12 0;
#X connect 11 0 9 2;
#X connect 11 1 12 1;
#X connect 12 0 13 0;
#X connect 13 0 14 0;
#X connect 15 0 49 0;
#X connect 18 0 17 1;
#X connect 19 0 17 0;
#X connect 19 1 18 0;
#X connect 20 0 17 0;
#X connect 22 0 1 2;
#X connect 24 0 29 1;
#X connect 26 0 30 0;
#X connect 26 1 28 0;
#X connect 26 2 24 0;
#X connect 27 0 26 0;
#X connect 28 0 29 0;
#X connect 29 0 25 2;
#X connect 30 0 25 0;
#X connect 31 0 33 1;
#X connect 32 0 33 0;
#X connect 33 0 36 0;
#X connect 34 0 38 0;
#X connect 35 0 43 0;
#X connect 36 0 34 1;
#X connect 36 1 37 0;
#X connect 36 2 35 2;
#X connect 37 0 35 1;
#X connect 38 0 46 0;
#X connect 39 0 41 1;
#X connect 40 0 41 0;
#X connect 41 0 42 2;
#X connect 43 0 42 0;
#X connect 44 0 45 0;
#X connect 45 0 34 0;
#X connect 45 1 32 0;
#X connect 45 2 31 0;
#X connect 45 3 40 0;
#X connect 45 4 39 0;
#X connect 46 0 35 0;
#X connect 46 1 42 1;
#X connect 47 0 1 0;
#X connect 48 0 19 0;
#X connect 50 0 51 0;
#X connect 58 0 59 0;
#X connect 60 0 65 1;
#X connect 62 0 66 0;
#X connect 62 1 64 0;
#X connect 62 2 60 0;
#X connect 63 0 62 0;
#X connect 64 0 65 0;
#X connect 65 0 61 2;
#X connect 66 0 61 0;
#X connect 67 0 69 1;
#X connect 68 0 69 0;
#X connect 69 0 72 0;
#X connect 70 0 74 0;
#X connect 71 0 85 0;
#X connect 72 0 70 1;
#X connect 72 1 73 0;
#X connect 72 2 71 2;
#X connect 73 0 71 1;
#X connect 74 0 81 0;
#X connect 75 0 77 1;
#X connect 76 0 77 0;
#X connect 77 0 78 2;
#X connect 79 0 80 0;
#X connect 80 0 70 0;
#X connect 80 1 68 0;
#X connect 80 2 67 0;
#X connect 80 3 76 0;
#X connect 80 4 75 0;
#X connect 81 0 71 0;
#X connect 81 1 78 1;
#X connect 84 0 92 0;
#X connect 85 0 78 0;
#X connect 88 0 87 1;
#X connect 89 0 87 0;
#X connect 89 1 88 0;
#X connect 90 0 87 0;
#X connect 91 0 89 0;
#X connect 93 0 98 1;
#X connect 95 0 99 0;
#X connect 95 1 97 0;
#X connect 95 2 93 0;
#X connect 96 0 95 0;
#X connect 97 0 98 0;
#X connect 98 0 94 2;
#X connect 99 0 94 0;
#X connect 101 0 11 0;
#X restore 305 547 pd test_dz;
#X obj 86 280 r \$0_reset_for_tests;
#X connect 0 0 1 0;
#X connect 1 0 45 0;
#X connect 1 1 2 0;
#X connect 2 0 3 0;
#X connect 6 0 7 0;
#X connect 8 0 9 0;
#X connect 17 0 16 1;
#X connect 19 0 18 0;
#X connect 22 0 21 0;
#X connect 23 0 28 0;
#X connect 25 0 24 0;
#X connect 26 0 27 0;
#X connect 29 0 30 0;
#X connect 33 0 4 0;
#X connect 34 0 5 0;
#X connect 35 0 11 0;
#X connect 36 0 13 0;
#X connect 37 0 14 0;
#X connect 38 0 15 0;
#X connect 39 0 40 0;
#X connect 41 0 42 0;
#X connect 43 0 44 0;
#X connect 45 0 16 0;
#X connect 45 1 33 0;
#X connect 45 2 34 0;
#X connect 45 3 6 0;
#X connect 45 4 8 0;
#X connect 45 5 47 0;
#X connect 45 6 35 0;
#X connect 45 7 49 0;
#X connect 45 8 36 0;
#X connect 45 9 37 0;
#X connect 45 10 38 0;
#X connect 45 11 39 0;
#X connect 45 12 41 0;
#X connect 45 13 43 0;
#X connect 47 0 10 0;
#X connect 49 0 12 0;
#X connect 58 0 17 0;
