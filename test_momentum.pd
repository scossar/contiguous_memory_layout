#N canvas 4 70 1712 1332 16;
#X msg 17 12 bang;
#X obj 17 134 t b b b b b b b b b b b b b, f 133;
#X obj 17 40 t b b;
#X obj 54 73 f \$0;
#X obj 54 101 v \$0_ns;
#X obj 105 216 v \$0_m;
#X obj 193 216 v \$0_nx;
#X msg 193 188 1;
#X msg 105 188 4;
#X msg 282 188 1;
#X obj 282 216 v \$0_ny;
#X msg 370 188 1;
#X obj 370 216 v \$0_nL-0;
#X obj 459 216 v \$0_nL-1;
#X obj 547 216 v \$0_nL-0;
#X obj 635 216 v \$0_nL-1;
#X obj 724 216 v \$0_nL-2;
#X obj 812 216 v \$0_nL-3;
#X obj 901 216 v \$0_nL-4;
#X obj 989 216 v \$0_nL-5;
#X obj 1078 216 v \$0_nL-6;
#X msg 459 188 2;
#X msg 547 188 2;
#X msg 635 188 2;
#X msg 724 188 2;
#X msg 812 188 2;
#X msg 901 188 2;
#X msg 989 188 2;
#X msg 1078 188 2;
#N canvas 0 66 3440 1340 arrays 0;
#X obj 513 196 array define \$0_X;
#X msg 513 163 resize \$1;
#X obj 513 130 *;
#X obj 513 97 v \$0_m;
#X obj 575 97 v \$0_nx;
#X obj 513 64 t b b;
#X obj 513 36 r \$0_size_arrays;
#X obj 61 36 inlet;
#X obj 61 69 s \$0_size_arrays;
#X msg 294 69 const 0;
#X msg 27 380 resize \$1;
#X obj 27 348 *;
#X obj 27 282 t b b;
#X obj 27 254 r \$0_size_arrays;
#X msg 377 348 resize \$1;
#X obj 377 254 r \$0_size_arrays;
#X msg 27 677 resize \$1;
#X obj 27 644 *;
#X obj 27 578 t b b;
#X obj 27 550 r \$0_size_arrays;
#X obj 117 611 v \$0_m;
#X text 29 225 // output layer;
#X obj 27 315 v \$0_nL-0;
#X obj 117 315 v \$0_nL-1;
#X obj 27 441 array define \$0_WL-0;
#X obj 67 474 array define \$0_dWL-0;
#X obj 377 315 v \$0_nL-0;
#X obj 377 441 array define \$0_bL-0;
#X obj 417 474 array define \$0_dbL-0;
#X obj 27 611 v \$0_nL-0;
#X obj 27 743 array define \$0_ZL-0;
#X obj 156 776 array define \$0_dZL-0;
#X obj 206 743 array define \$0_AL-0;
#X obj 337 776 array define \$0_dAL-0;
#X obj 27 710 t a a a a, f 34;
#X obj 107 507 array define \$0_VdWL-0;
#X obj 457 507 array define \$0_VdbL-0;
#X obj 27 408 t a a a;
#X obj 377 376 t a a a;
#X obj 294 102 s \$0_const_arrays;
#X obj 232 254 r \$0_const_arrays;
#X obj 202 550 r \$0_const_arrays;
#X msg 657 380 resize \$1;
#X obj 657 348 *;
#X obj 657 282 t b b;
#X obj 657 254 r \$0_size_arrays;
#X msg 1007 348 resize \$1;
#X obj 1007 254 r \$0_size_arrays;
#X msg 657 677 resize \$1;
#X obj 657 644 *;
#X obj 657 578 t b b;
#X obj 657 550 r \$0_size_arrays;
#X obj 747 611 v \$0_m;
#X obj 657 710 t a a a a, f 34;
#X obj 657 408 t a a a;
#X obj 1007 376 t a a a;
#X obj 862 254 r \$0_const_arrays;
#X obj 832 550 r \$0_const_arrays;
#X obj 657 315 v \$0_nL-1;
#X obj 747 315 v \$0_nL-2;
#X obj 1007 315 v \$0_nL-1;
#X obj 657 441 array define \$0_WL-1;
#X obj 697 474 array define \$0_dWL-1;
#X obj 737 507 array define \$0_VdWL-1;
#X obj 1007 441 array define \$0_bL-1;
#X obj 1047 474 array define \$0_dbL-1;
#X obj 1087 507 array define \$0_VdbL-1;
#X obj 657 743 array define \$0_ZL-1;
#X obj 836 743 array define \$0_AL-1;
#X obj 786 776 array define \$0_dZL-1;
#X obj 967 776 array define \$0_dAL-1;
#X text 667 222 // L-1;
#X obj 657 611 v \$0_nL-1;
#X msg 1287 380 resize \$1;
#X obj 1287 348 *;
#X obj 1287 282 t b b;
#X obj 1287 254 r \$0_size_arrays;
#X msg 1637 348 resize \$1;
#X obj 1637 254 r \$0_size_arrays;
#X msg 1287 677 resize \$1;
#X obj 1287 644 *;
#X obj 1287 578 t b b;
#X obj 1287 550 r \$0_size_arrays;
#X obj 1377 611 v \$0_m;
#X obj 1287 710 t a a a a, f 34;
#X obj 1287 408 t a a a;
#X obj 1637 376 t a a a;
#X obj 1492 254 r \$0_const_arrays;
#X obj 1462 550 r \$0_const_arrays;
#X text 1291 225 // L-2;
#X obj 1287 315 v \$0_nL-2;
#X obj 1377 315 v \$0_nL-1;
#X obj 1637 315 v \$0_nL-2;
#X obj 1287 441 array define \$0_WL-2;
#X obj 1327 474 array define \$0_dWL-2;
#X obj 1367 507 array define \$0_VdWL-2;
#X obj 1637 441 array define \$0_bL-2;
#X obj 1675 474 array define \$0_dbL-2;
#X obj 1717 507 array define \$0_VdbL-2;
#X obj 1287 611 v \$0_nL-2;
#X obj 1287 743 array define \$0_ZL-2;
#X obj 1466 743 array define \$0_AL-2;
#X obj 1416 776 array define \$0_dZL-2;
#X obj 1597 776 array define \$0_dAL-2;
#X msg 1917 380 resize \$1;
#X obj 1917 348 *;
#X obj 1917 282 t b b;
#X obj 1917 254 r \$0_size_arrays;
#X msg 2267 348 resize \$1;
#X obj 2267 254 r \$0_size_arrays;
#X msg 1917 677 resize \$1;
#X obj 1917 644 *;
#X obj 1917 578 t b b;
#X obj 1917 550 r \$0_size_arrays;
#X obj 2007 611 v \$0_m;
#X obj 1917 710 t a a a a, f 34;
#X obj 1917 408 t a a a;
#X obj 2267 376 t a a a;
#X obj 2122 254 r \$0_const_arrays;
#X obj 2092 550 r \$0_const_arrays;
#X obj 294 36 inlet cont_arrays;
#X obj 662 36 r \$0_const_arrays;
#X text 1918 228 // L-3;
#X obj 1917 315 v \$0_nL-3;
#X obj 2007 315 v \$0_nL-2;
#X obj 2267 315 v \$0_nL-3;
#X obj 1917 441 array define \$0_WL-3;
#X obj 1957 474 array define \$0_dWL-3;
#X obj 1997 507 array define \$0_VdWL-3;
#X obj 2267 441 array define \$0_bL-3;
#X obj 2308 474 array define \$0_dbL-3;
#X obj 2347 507 array define \$0_VdbL-3;
#X obj 1917 611 v \$0_nL-3;
#X obj 1917 743 array define \$0_ZL-3;
#X obj 2096 743 array define \$0_AL-3;
#X obj 2046 776 array define \$0_dZL-3;
#X obj 2227 776 array define \$0_dAL-3;
#X obj 232 282 t a a a a a a;
#X obj 202 578 t a a a a;
#X obj 862 281 t a a a a a a;
#X obj 832 578 t a a a a;
#X obj 1492 282 t a a a a a a;
#X obj 1462 578 t a a a a;
#X obj 2122 282 t a a a a a a;
#X obj 2092 578 t a a a a;
#X connect 1 0 0 0;
#X connect 2 0 1 0;
#X connect 3 0 2 0;
#X connect 4 0 2 1;
#X connect 5 0 3 0;
#X connect 5 1 4 0;
#X connect 6 0 5 0;
#X connect 7 0 8 0;
#X connect 9 0 39 0;
#X connect 10 0 37 0;
#X connect 11 0 10 0;
#X connect 12 0 22 0;
#X connect 12 1 23 0;
#X connect 13 0 12 0;
#X connect 14 0 38 0;
#X connect 15 0 26 0;
#X connect 16 0 34 0;
#X connect 17 0 16 0;
#X connect 18 0 29 0;
#X connect 18 1 20 0;
#X connect 19 0 18 0;
#X connect 20 0 17 1;
#X connect 22 0 11 0;
#X connect 23 0 11 1;
#X connect 26 0 14 0;
#X connect 29 0 17 0;
#X connect 34 0 30 0;
#X connect 34 1 31 0;
#X connect 34 2 32 0;
#X connect 34 3 33 0;
#X connect 37 0 24 0;
#X connect 37 1 25 0;
#X connect 37 2 35 0;
#X connect 38 0 27 0;
#X connect 38 1 28 0;
#X connect 38 2 36 0;
#X connect 40 0 137 0;
#X connect 41 0 138 0;
#X connect 42 0 54 0;
#X connect 43 0 42 0;
#X connect 44 0 58 0;
#X connect 44 1 59 0;
#X connect 45 0 44 0;
#X connect 46 0 55 0;
#X connect 47 0 60 0;
#X connect 48 0 53 0;
#X connect 49 0 48 0;
#X connect 50 0 72 0;
#X connect 50 1 52 0;
#X connect 51 0 50 0;
#X connect 52 0 49 1;
#X connect 53 0 67 0;
#X connect 53 1 69 0;
#X connect 53 2 68 0;
#X connect 53 3 70 0;
#X connect 54 0 61 0;
#X connect 54 1 62 0;
#X connect 54 2 63 0;
#X connect 55 0 64 0;
#X connect 55 1 65 0;
#X connect 55 2 66 0;
#X connect 56 0 139 0;
#X connect 57 0 140 0;
#X connect 58 0 43 0;
#X connect 59 0 43 1;
#X connect 60 0 46 0;
#X connect 72 0 49 0;
#X connect 73 0 85 0;
#X connect 74 0 73 0;
#X connect 75 0 90 0;
#X connect 75 1 91 0;
#X connect 76 0 75 0;
#X connect 77 0 86 0;
#X connect 78 0 92 0;
#X connect 79 0 84 0;
#X connect 80 0 79 0;
#X connect 81 0 99 0;
#X connect 81 1 83 0;
#X connect 82 0 81 0;
#X connect 83 0 80 1;
#X connect 84 0 100 0;
#X connect 84 1 102 0;
#X connect 84 2 101 0;
#X connect 84 3 103 0;
#X connect 85 0 93 0;
#X connect 85 1 94 0;
#X connect 85 2 95 0;
#X connect 86 0 96 0;
#X connect 86 1 97 0;
#X connect 86 2 98 0;
#X connect 87 0 141 0;
#X connect 88 0 142 0;
#X connect 90 0 74 0;
#X connect 91 0 74 1;
#X connect 92 0 77 0;
#X connect 99 0 80 0;
#X connect 104 0 116 0;
#X connect 105 0 104 0;
#X connect 106 0 123 0;
#X connect 106 1 124 0;
#X connect 107 0 106 0;
#X connect 108 0 117 0;
#X connect 109 0 125 0;
#X connect 110 0 115 0;
#X connect 111 0 110 0;
#X connect 112 0 132 0;
#X connect 112 1 114 0;
#X connect 113 0 112 0;
#X connect 114 0 111 1;
#X connect 115 0 133 0;
#X connect 115 1 135 0;
#X connect 115 2 134 0;
#X connect 115 3 136 0;
#X connect 116 0 126 0;
#X connect 116 1 127 0;
#X connect 116 2 128 0;
#X connect 117 0 129 0;
#X connect 117 1 130 0;
#X connect 117 2 131 0;
#X connect 118 0 143 0;
#X connect 119 0 144 0;
#X connect 120 0 9 0;
#X connect 121 0 0 0;
#X connect 123 0 105 0;
#X connect 124 0 105 1;
#X connect 125 0 108 0;
#X connect 132 0 111 0;
#X connect 137 0 24 0;
#X connect 137 1 25 0;
#X connect 137 2 35 0;
#X connect 137 3 27 0;
#X connect 137 4 28 0;
#X connect 137 5 36 0;
#X connect 138 0 30 0;
#X connect 138 1 31 0;
#X connect 138 2 32 0;
#X connect 138 3 33 0;
#X connect 139 0 61 0;
#X connect 139 1 62 0;
#X connect 139 2 63 0;
#X connect 139 3 64 0;
#X connect 139 4 65 0;
#X connect 139 5 66 0;
#X connect 140 0 67 0;
#X connect 140 1 69 0;
#X connect 140 2 68 0;
#X connect 140 3 70 0;
#X connect 141 0 93 0;
#X connect 141 1 94 0;
#X connect 141 2 95 0;
#X connect 141 3 96 0;
#X connect 141 4 97 0;
#X connect 141 5 98 0;
#X connect 142 0 100 0;
#X connect 142 1 102 0;
#X connect 142 2 101 0;
#X connect 142 3 103 0;
#X connect 143 0 126 0;
#X connect 143 1 127 0;
#X connect 143 2 128 0;
#X connect 143 3 129 0;
#X connect 143 4 130 0;
#X connect 143 5 131 0;
#X connect 144 0 133 0;
#X connect 144 1 135 0;
#X connect 144 2 134 0;
#X connect 144 3 136 0;
#X restore 17 282 pd arrays;
#X msg 468 482 1;
#X obj 468 515 cml.array_name dA;
#X obj 601 482 v \$0_ns;
#X msg 210 443 0.1 0.2 0.3 0.4 0.2 0.3 0.4 0.5;
#X obj 210 400 t b b b, f 46;
#X obj 210 569 array set;
#X msg 968 482 1;
#X obj 1093 482 v \$0_ns;
#X obj 710 400 t b b b, f 46;
#X obj 710 569 array set;
#X obj 968 514 cml.array_name W;
#X msg 710 443 0.1 0.2 0.3 0.4;
#X msg 1410 482 1;
#X obj 1535 482 v \$0_ns;
#X obj 1170 400 t b b b, f 46;
#X obj 1170 569 array set;
#X obj 1410 514 cml.array_name b;
#X msg 1170 443 0.1 0.2;
#X obj 130 1028 cml.layer_backward;
#X obj 130 1154 cml.update_layer_params;
#X obj 271 995 v \$0_ns;
#X obj 311 1121 v \$0_ns;
#X msg 162 944 layer_number 1 \, layer_dims 2 2 \, m 4 \, activation linear \, skip_dz 0 \, momentum 1 \, beta 0.9;
#X msg 130 883 bang;
#X obj 130 911 t b b b;
#X obj 130 1056 t b b b;
#X msg 210 367 bang;
#X msg 710 367 bang;
#X msg 1170 367 bang;
#X obj 1106 1073 array get;
#X obj 1300 1012 v \$0_ns;
#X obj 1106 975 t b b b;
#X msg 1106 945 bang;
#X obj 1106 1115 print;
#X obj 601 722 v \$0_ns;
#X obj 210 640 t b b b, f 46;
#X obj 210 809 array set;
#X msg 210 607 bang;
#X obj 468 755 cml.array_name A;
#X msg 210 683 0.2 0.3 0.1 0.5 0.6 0.7 0.4 0.8;
#X msg 468 722 2;
#X msg 1175 1012 1;
#X msg 161 1089 layer_number 1 \, layer_dims 2 2 \, alpha 0.1 \, momentum 1;
#X msg 86 249 bang;
#X obj 1176 1044 cml.array_name VdW;
#X connect 0 0 2 0;
#X connect 1 0 29 0;
#X connect 1 1 8 0;
#X connect 1 2 7 0;
#X connect 1 3 9 0;
#X connect 1 4 11 0;
#X connect 1 5 21 0;
#X connect 1 6 22 0;
#X connect 1 7 23 0;
#X connect 1 8 24 0;
#X connect 1 9 25 0;
#X connect 1 10 26 0;
#X connect 1 11 27 0;
#X connect 1 12 28 0;
#X connect 2 0 1 0;
#X connect 2 1 3 0;
#X connect 3 0 4 0;
#X connect 7 0 6 0;
#X connect 8 0 5 0;
#X connect 9 0 10 0;
#X connect 11 0 12 0;
#X connect 21 0 13 0;
#X connect 22 0 14 0;
#X connect 23 0 15 0;
#X connect 24 0 16 0;
#X connect 25 0 17 0;
#X connect 26 0 18 0;
#X connect 27 0 19 0;
#X connect 28 0 20 0;
#X connect 30 0 31 0;
#X connect 31 0 35 2;
#X connect 32 0 31 1;
#X connect 33 0 35 0;
#X connect 34 0 33 0;
#X connect 34 1 30 0;
#X connect 34 2 32 0;
#X connect 36 0 40 0;
#X connect 37 0 40 1;
#X connect 38 0 41 0;
#X connect 38 1 36 0;
#X connect 38 2 37 0;
#X connect 40 0 39 2;
#X connect 41 0 39 0;
#X connect 42 0 46 0;
#X connect 43 0 46 1;
#X connect 44 0 47 0;
#X connect 44 1 42 0;
#X connect 44 2 43 0;
#X connect 46 0 45 2;
#X connect 47 0 45 0;
#X connect 48 0 55 0;
#X connect 50 0 48 1;
#X connect 51 0 49 1;
#X connect 52 0 48 0;
#X connect 53 0 54 0;
#X connect 54 0 48 0;
#X connect 54 1 52 0;
#X connect 54 2 50 0;
#X connect 55 0 49 0;
#X connect 55 1 72 0;
#X connect 55 2 51 0;
#X connect 56 0 34 0;
#X connect 57 0 38 0;
#X connect 58 0 44 0;
#X connect 59 0 63 0;
#X connect 60 0 74 1;
#X connect 61 0 59 0;
#X connect 61 1 71 0;
#X connect 61 2 60 0;
#X connect 62 0 61 0;
#X connect 64 0 68 1;
#X connect 65 0 69 0;
#X connect 65 1 70 0;
#X connect 65 2 64 0;
#X connect 67 0 65 0;
#X connect 68 0 66 2;
#X connect 69 0 66 0;
#X connect 70 0 68 0;
#X connect 71 0 74 0;
#X connect 72 0 49 0;
#X connect 73 0 29 1;
#X connect 74 0 59 2;
