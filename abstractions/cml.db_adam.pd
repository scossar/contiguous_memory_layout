#N canvas 161 239 1962 1055 16;
#X text 32 461 // db^[l] = 1/m sum(dZ^[l]) \;;
#X obj 28 52 inlet bang;
#X obj 433 511 array sum, f 13;
#X obj 487 678 array set;
#X obj 433 544 /, f 8;
#X obj 28 823 outlet done;
#X obj 28 85 t b b;
#X obj 406 52 inlet m;
#X obj 268 52 inlet n;
#X obj 247 155 f;
#X obj 247 183 cml.range;
#X obj 385 244 *;
#X obj 406 85 t f f f, f 12;
#X obj 545 52 inlet s_dz;
#X obj 692 52 inlet s_db;
#X obj 1056 828 array set, f 49;
#X text 328 183 // for n in range(num_nodes) \;;
#X text 34 524 // dZ is a 1D array of size (m * num_nodes) \; There is 1 db/Vdb value for each node \; m sets the number of values to sum \; n * m sets the element to start summing from \;;
#X obj 1391 52 inlet rho;
#X obj 1056 795 expr $f3 * $f2 + (1 - $f3) * pow($f1 \, 2);
#X text 37 640 // RMSProp \; Sdb = rho * Sdb + (1 - rho) * db^2 \;;
#X text 34 691 // momentum \; Vdb = mu * Vdb + (1 - mu) * db \;;
#X obj 703 795 expr $f3 * $f2 + (1 - $f3) * $f1;
#X obj 922 52 inlet s_vdb;
#X obj 1227 52 inlet s_sdb;
#X obj 1071 52 inlet mu;
#X obj 703 828 array set, f 42;
#X obj 247 211 t b f f f f f f, f 104;
#X obj 433 577 t f f f, f 28;
#N canvas 2109 630 450 300 vdb_array 0;
#X obj 165 42 inlet s_vdb;
#X obj 165 70 t b s;
#X obj 129 127 array get;
#X msg 165 98 1;
#X obj 45 42 inlet index;
#X obj 129 155 outlet;
#X connect 0 0 1 0;
#X connect 1 0 3 0;
#X connect 1 1 2 2;
#X connect 2 0 5 0;
#X connect 3 0 2 1;
#X connect 4 0 2 0;
#X restore 829 762 pd vdb_array;
#X obj 922 80 t s s, f 15;
#N canvas 2113 666 450 300 sdb_array 0;
#X obj 165 70 t b s;
#X obj 129 127 array get;
#X msg 165 98 1;
#X obj 45 42 inlet index;
#X obj 129 155 outlet;
#X obj 165 42 inlet s_sdb;
#X connect 0 0 2 0;
#X connect 0 1 1 2;
#X connect 1 0 4 0;
#X connect 2 0 1 1;
#X connect 3 0 1 0;
#X connect 5 0 0 0;
#X restore 1214 762 pd sdb_array;
#X obj 1227 80 t s s, f 28;
#X connect 1 0 6 0;
#X connect 2 0 4 0;
#X connect 4 0 28 0;
#X connect 6 0 5 0;
#X connect 6 1 9 0;
#X connect 7 0 12 0;
#X connect 8 0 9 1;
#X connect 9 0 10 0;
#X connect 10 0 27 0;
#X connect 11 0 2 0;
#X connect 12 0 11 1;
#X connect 12 1 2 1;
#X connect 12 2 4 1;
#X connect 13 0 2 2;
#X connect 14 0 3 2;
#X connect 18 0 19 2;
#X connect 19 0 15 0;
#X connect 22 0 26 0;
#X connect 23 0 30 0;
#X connect 24 0 32 0;
#X connect 25 0 22 2;
#X connect 27 0 2 0;
#X connect 27 1 11 0;
#X connect 27 2 3 1;
#X connect 27 3 29 0;
#X connect 27 4 26 1;
#X connect 27 5 31 0;
#X connect 27 6 15 1;
#X connect 28 0 3 0;
#X connect 28 1 22 0;
#X connect 28 2 19 0;
#X connect 29 0 22 1;
#X connect 30 0 29 1;
#X connect 30 1 26 2;
#X connect 31 0 19 1;
#X connect 32 0 31 1;
#X connect 32 1 15 2;
