#N canvas 1724 70 1712 1332 16;
#X obj 34 15 inlet;
#X obj 1768 19 inlet dollar_zero;
#X obj 363 85 list split 1;
#X obj 692 113 select relu tanh sigmoid linear;
#X msg 692 146 1;
#X msg 753 146 2;
#X msg 814 146 3;
#X msg 873 146 4;
#X msg 937 146 0;
#X obj 1768 52 s \$0_ns;
#X obj 198 85 s \$0_l;
#X obj 363 147 s \$0_n;
#X obj 409 113 s \$0_n_prev;
#X obj 856 85 s \$0_leak;
#X obj 814 207 s \$0_activation;
#X obj 692 86 symbol;
#X obj 1021 85 s \$0_skip_dz;
#X obj 1185 85 s \$0_initial_layer;
#X obj 527 85 s \$0_m;
#X obj 60 379 cml.dz, f 205;
#X obj 490 313 r \$0_m;
#X obj 694 280 r \$0_l;
#X obj 806 313 r \$0_ns;
#X obj 673 346 cml.array_name dA;
#X obj 899 280 r \$0_l;
#X obj 1003 313 r \$0_ns;
#X obj 878 346 cml.array_name Z;
#X obj 1208 313 r \$0_ns;
#X obj 1083 346 cml.array_name A;
#X obj 1420 313 r \$0_ns;
#X obj 1287 346 cml.array_name dZ;
#X obj 1513 313 r \$0_leak;
#X obj 1718 315 r \$0_activation;
#X obj 1392 580 r \$0_initial_layer;
#N canvas 1035 607 526 394 a_prev_for_layer 0;
#X obj 55 251 cml.array_name A;
#X obj 255 251 cml.input_name;
#X obj 76 160 r \$0_l;
#X obj 76 188 + 1;
#X obj 180 218 r \$0_ns;
#X obj 364 218 r \$0_ns;
#X obj 81 67 t f f, f 18;
#X obj 81 95 != 1;
#X obj 222 95 == 1;
#X obj 81 123 sel 1;
#X obj 222 123 sel 1;
#X obj 55 216 f;
#X obj 81 34 inlet;
#X obj 55 304 outlet;
#X connect 0 0 13 0;
#X connect 1 0 13 0;
#X connect 2 0 3 0;
#X connect 3 0 11 1;
#X connect 4 0 0 1;
#X connect 5 0 1 1;
#X connect 6 0 7 0;
#X connect 6 1 8 0;
#X connect 7 0 9 0;
#X connect 8 0 10 0;
#X connect 9 0 11 0;
#X connect 10 0 1 0;
#X connect 11 0 0 0;
#X connect 12 0 6 0;
#X restore 1371 646 pd a_prev_for_layer;
#X obj 476 613 r \$0_n;
#X obj 705 613 r \$0_n_prev;
#X obj 934 613 r \$0_m;
#X obj 1275 611 r \$0_ns;
#X obj 1142 644 cml.array_name dZ;
#X obj 1733 613 r \$0_ns;
#X obj 1600 646 cml.array_name dW;
#X obj 227 679 cml.dw, f 172;
#X obj 2087 319 cml.db, f 108;
#X obj 2323 253 r \$0_n;
#X obj 2538 253 r \$0_m;
#X obj 2865 253 r \$0_ns;
#X obj 2732 286 cml.array_name dZ;
#X obj 3081 253 r \$0_ns;
#X obj 2948 286 cml.array_name db;
#X obj 1920 1110 cml.da, f 164;
#X obj 2595 1044 r \$0_n;
#X obj 2159 1044 r \$0_n_prev;
#X obj 2377 1044 r \$0_m;
#X obj 3143 1044 r \$0_ns;
#X obj 3010 1077 cml.array_name dZ;
#X obj 2917 1044 r \$0_ns;
#X obj 2792 1077 cml.array_name W;
#X obj 3361 1044 r \$0_ns;
#X obj 3229 1044 + 1;
#X obj 1894 1291 outlet bang;
#X obj 3229 1077 cml.array_name dA;
#X obj 285 313 r \$0_n;
#X obj 264 346 f;
#X obj 469 346 f;
#X obj 673 313 f;
#X obj 878 313 f;
#X obj 1104 280 r \$0_l;
#X obj 1083 313 f;
#X obj 1308 280 r \$0_l;
#X obj 1287 313 f;
#X obj 1492 346 f;
#X obj 1697 346 f;
#X obj 1621 580 r \$0_l;
#X obj 1600 613 f;
#X obj 1163 578 r \$0_l;
#X obj 1142 611 f;
#X obj 1371 613 f 0;
#X obj 455 646 f;
#X obj 684 646 f;
#X obj 913 646 f;
#X obj 2302 286 f;
#X obj 2517 286 f;
#X obj 2753 221 r \$0_l;
#X obj 2732 254 f;
#X obj 2969 220 r \$0_l;
#X obj 2948 253 f;
#X obj 2813 1011 r \$0_l;
#X obj 2792 1044 f;
#X obj 3031 1011 r \$0_l;
#X obj 3010 1044 f;
#X obj 3250 978 r \$0_l;
#X obj 3229 1011 f;
#X obj 2138 1077 f;
#X obj 2356 1077 f;
#X obj 2574 1077 f;
#X obj 1350 84 s \$0_momentum;
#X obj 34 52 route bang layer_number layer_dims m activation leak skip_dz initial_layer momentum beta, f 206;
#X obj 1514 84 s \$0_beta;
#X obj 1124 834 r \$0_initial_layer;
#N canvas 1035 607 526 394 a_prev_for_layer 0;
#X obj 55 251 cml.array_name A;
#X obj 255 251 cml.input_name;
#X obj 76 160 r \$0_l;
#X obj 76 188 + 1;
#X obj 180 218 r \$0_ns;
#X obj 364 218 r \$0_ns;
#X obj 81 67 t f f, f 18;
#X obj 81 95 != 1;
#X obj 222 95 == 1;
#X obj 81 123 sel 1;
#X obj 222 123 sel 1;
#X obj 55 216 f;
#X obj 81 34 inlet;
#X obj 55 304 outlet;
#X connect 0 0 13 0;
#X connect 1 0 13 0;
#X connect 2 0 3 0;
#X connect 3 0 11 1;
#X connect 4 0 0 1;
#X connect 5 0 1 1;
#X connect 6 0 7 0;
#X connect 6 1 8 0;
#X connect 7 0 9 0;
#X connect 8 0 10 0;
#X connect 9 0 11 0;
#X connect 10 0 1 0;
#X connect 11 0 0 0;
#X connect 12 0 6 0;
#X restore 1103 900 pd a_prev_for_layer;
#X obj 301 867 r \$0_n;
#X obj 507 867 r \$0_n_prev;
#X obj 712 867 r \$0_m;
#X obj 1030 865 r \$0_ns;
#X obj 897 898 cml.array_name dZ;
#X obj 1441 865 r \$0_ns;
#X obj 1308 898 cml.array_name dW;
#X obj 1329 832 r \$0_l;
#X obj 1308 865 f;
#X obj 918 832 r \$0_l;
#X obj 897 865 f;
#X obj 1103 867 f 0;
#X obj 280 900 f;
#X obj 486 900 f;
#X obj 691 900 f;
#X obj 75 933 cml.dw_with_momentum, f 206;
#X obj 1655 865 r \$0_ns;
#X obj 1535 832 r \$0_l;
#X obj 1514 865 f;
#X obj 1514 898 cml.array_name VdW;
#X obj 1720 865 f;
#X obj 1741 832 r \$0_beta;
#X obj 157 712 r \$0_momentum;
#X obj 136 740 f;
#X obj 75 773 spigot 0;
#X obj 309 423 r \$0_momentum;
#X obj 288 456 f;
#X obj 34 412 t b b b b b, f 21;
#X obj 227 517 spigot 1;
#X obj 288 484 != 1;
#X obj 227 545 t b b b b b b b, f 172;
#X obj 75 801 t b b b b b b b b b, f 206;
#X obj 34 118 t b b b;
#X obj 60 214 spigot 1;
#X obj 121 184 != 1;
#X obj 142 118 r \$0_skip_dz;
#X obj 121 151 f 0;
#X obj 60 247 t b b b b b b b b b, f 205;
#X obj 1935 572 cml.db_with_momentum, f 153;
#X obj 2017 352 r \$0_momentum;
#X obj 1996 380 f;
#X obj 1935 413 spigot 0;
#X obj 2169 63 r \$0_momentum;
#X obj 2148 96 f;
#X obj 1894 52 t b b b b b, f 21;
#X obj 2087 157 spigot 1;
#X obj 2148 124 != 1;
#X obj 1920 950 spigot 1;
#X obj 2002 852 r \$0_initial_layer;
#X obj 1981 918 != 1;
#X obj 1981 885 f 0;
#X obj 1920 978 t b b b b b b b, f 164;
#X obj 2087 188 t b b b b b, f 108;
#X obj 1894 820 t b b b;
#X obj 2159 506 r \$0_n;
#X obj 2363 506 r \$0_m;
#X obj 2678 506 r \$0_ns;
#X obj 2545 539 cml.array_name dZ;
#X obj 2882 506 r \$0_ns;
#X obj 2749 539 cml.array_name db;
#X obj 2138 539 f;
#X obj 2342 539 f;
#X obj 2566 474 r \$0_l;
#X obj 2545 507 f;
#X obj 2770 473 r \$0_l;
#X obj 2749 506 f;
#X obj 3093 506 r \$0_ns;
#X obj 2973 473 r \$0_l;
#X obj 2952 506 f;
#X obj 2952 539 cml.array_name Vdb;
#X obj 3156 539 f;
#X obj 3177 506 r \$0_beta;
#X obj 1935 441 t b b b b b b b, f 153;
#X connect 0 0 97 0;
#X connect 1 0 9 0;
#X connect 2 0 11 0;
#X connect 2 1 12 0;
#X connect 3 0 4 0;
#X connect 3 1 5 0;
#X connect 3 2 6 0;
#X connect 3 3 7 0;
#X connect 3 4 8 0;
#X connect 4 0 14 0;
#X connect 5 0 14 0;
#X connect 6 0 14 0;
#X connect 7 0 14 0;
#X connect 8 0 14 0;
#X connect 15 0 3 0;
#X connect 20 0 64 1;
#X connect 21 0 65 1;
#X connect 22 0 23 1;
#X connect 23 0 19 3;
#X connect 24 0 66 1;
#X connect 25 0 26 1;
#X connect 26 0 19 4;
#X connect 27 0 28 1;
#X connect 28 0 19 5;
#X connect 29 0 30 1;
#X connect 30 0 19 6;
#X connect 31 0 71 1;
#X connect 32 0 72 1;
#X connect 33 0 77 1;
#X connect 34 0 42 5;
#X connect 35 0 78 1;
#X connect 36 0 79 1;
#X connect 37 0 80 1;
#X connect 38 0 39 1;
#X connect 39 0 42 4;
#X connect 40 0 41 1;
#X connect 41 0 42 6;
#X connect 44 0 81 1;
#X connect 45 0 82 1;
#X connect 46 0 47 1;
#X connect 47 0 43 3;
#X connect 48 0 49 1;
#X connect 49 0 43 4;
#X connect 51 0 95 1;
#X connect 52 0 93 1;
#X connect 53 0 94 1;
#X connect 54 0 55 1;
#X connect 55 0 50 5;
#X connect 56 0 57 1;
#X connect 57 0 50 4;
#X connect 58 0 61 1;
#X connect 59 0 61 0;
#X connect 61 0 50 6;
#X connect 62 0 63 1;
#X connect 63 0 19 1;
#X connect 64 0 19 2;
#X connect 65 0 23 0;
#X connect 66 0 26 0;
#X connect 67 0 68 1;
#X connect 68 0 28 0;
#X connect 69 0 70 1;
#X connect 70 0 30 0;
#X connect 71 0 19 7;
#X connect 72 0 19 8;
#X connect 73 0 74 1;
#X connect 74 0 41 0;
#X connect 75 0 76 1;
#X connect 76 0 39 0;
#X connect 77 0 34 0;
#X connect 78 0 42 1;
#X connect 79 0 42 2;
#X connect 80 0 42 3;
#X connect 81 0 43 1;
#X connect 82 0 43 2;
#X connect 83 0 84 1;
#X connect 84 0 47 0;
#X connect 85 0 86 1;
#X connect 86 0 49 0;
#X connect 87 0 88 1;
#X connect 88 0 57 0;
#X connect 89 0 90 1;
#X connect 90 0 55 0;
#X connect 91 0 92 1;
#X connect 92 0 59 0;
#X connect 93 0 50 1;
#X connect 94 0 50 2;
#X connect 95 0 50 3;
#X connect 97 0 133 0;
#X connect 97 1 10 0;
#X connect 97 2 2 0;
#X connect 97 3 18 0;
#X connect 97 4 15 0;
#X connect 97 5 13 0;
#X connect 97 6 16 0;
#X connect 97 7 17 0;
#X connect 97 8 96 0;
#X connect 97 9 98 0;
#X connect 99 0 112 1;
#X connect 100 0 116 5;
#X connect 101 0 113 1;
#X connect 102 0 114 1;
#X connect 103 0 115 1;
#X connect 104 0 105 1;
#X connect 105 0 116 4;
#X connect 106 0 107 1;
#X connect 107 0 116 6;
#X connect 108 0 109 1;
#X connect 109 0 107 0;
#X connect 110 0 111 1;
#X connect 111 0 105 0;
#X connect 112 0 100 0;
#X connect 113 0 116 1;
#X connect 114 0 116 2;
#X connect 115 0 116 3;
#X connect 117 0 120 1;
#X connect 118 0 119 1;
#X connect 119 0 120 0;
#X connect 120 0 116 7;
#X connect 121 0 116 8;
#X connect 122 0 121 1;
#X connect 123 0 124 1;
#X connect 124 0 125 1;
#X connect 125 0 132 0;
#X connect 126 0 127 1;
#X connect 127 0 130 0;
#X connect 128 0 145 0;
#X connect 128 1 125 0;
#X connect 128 2 124 0;
#X connect 128 3 129 0;
#X connect 128 4 127 0;
#X connect 129 0 131 0;
#X connect 130 0 129 1;
#X connect 131 0 42 0;
#X connect 131 1 78 0;
#X connect 131 2 79 0;
#X connect 131 3 80 0;
#X connect 131 4 76 0;
#X connect 131 5 77 0;
#X connect 131 6 74 0;
#X connect 132 0 116 0;
#X connect 132 1 113 0;
#X connect 132 2 114 0;
#X connect 132 3 115 0;
#X connect 132 4 111 0;
#X connect 132 5 112 0;
#X connect 132 6 109 0;
#X connect 132 7 119 0;
#X connect 132 8 121 0;
#X connect 133 0 128 0;
#X connect 133 1 134 0;
#X connect 133 2 137 0;
#X connect 134 0 138 0;
#X connect 135 0 134 1;
#X connect 136 0 137 1;
#X connect 137 0 135 0;
#X connect 138 0 19 0;
#X connect 138 1 63 0;
#X connect 138 2 64 0;
#X connect 138 3 65 0;
#X connect 138 4 66 0;
#X connect 138 5 68 0;
#X connect 138 6 70 0;
#X connect 138 7 71 0;
#X connect 138 8 72 0;
#X connect 140 0 141 1;
#X connect 141 0 142 1;
#X connect 142 0 173 0;
#X connect 143 0 144 1;
#X connect 144 0 147 0;
#X connect 145 0 154 0;
#X connect 145 1 142 0;
#X connect 145 2 141 0;
#X connect 145 3 146 0;
#X connect 145 4 144 0;
#X connect 146 0 153 0;
#X connect 147 0 146 1;
#X connect 148 0 152 0;
#X connect 149 0 151 1;
#X connect 150 0 148 1;
#X connect 151 0 150 0;
#X connect 152 0 50 0;
#X connect 152 1 93 0;
#X connect 152 2 94 0;
#X connect 152 3 95 0;
#X connect 152 4 88 0;
#X connect 152 5 90 0;
#X connect 152 6 92 0;
#X connect 153 0 43 0;
#X connect 153 1 81 0;
#X connect 153 2 82 0;
#X connect 153 3 84 0;
#X connect 153 4 86 0;
#X connect 154 0 60 0;
#X connect 154 1 148 0;
#X connect 154 2 151 0;
#X connect 155 0 161 1;
#X connect 156 0 162 1;
#X connect 157 0 158 1;
#X connect 158 0 139 3;
#X connect 159 0 160 1;
#X connect 160 0 139 4;
#X connect 161 0 139 1;
#X connect 162 0 139 2;
#X connect 163 0 164 1;
#X connect 164 0 158 0;
#X connect 165 0 166 1;
#X connect 166 0 160 0;
#X connect 167 0 170 1;
#X connect 168 0 169 1;
#X connect 169 0 170 0;
#X connect 170 0 139 5;
#X connect 171 0 139 6;
#X connect 172 0 171 1;
#X connect 173 0 139 0;
#X connect 173 1 161 0;
#X connect 173 2 162 0;
#X connect 173 3 164 0;
#X connect 173 4 166 0;
#X connect 173 5 169 0;
#X connect 173 6 171 0;
