#N canvas 1375 70 1986 1315 16;
#X obj 36 69 inlet bang;
#X obj 1196 69 inlet activation_number;
#X obj 36 780 outlet done;
#X obj 309 435 array get;
#X obj 309 717 array set, f 66;
#X obj 309 684 *;
#X msg 343 399 1;
#X obj 36 102 t b b, f 6;
#X obj 991 69 inlet negative_slope;
#X obj 445 69 inlet s_z;
#X obj 652 69 inlet s_a;
#X obj 895 69 inlet s_dz;
#X obj 260 72 inlet m;
#X text 37 9 // dZ^[l] = dA^[l] x g^[l]'(Z^[l]);
#X obj 341 105 t b s;
#X obj 341 72 inlet s_da;
#X obj 239 223 cml.range;
#X obj 154 72 inlet n;
#X obj 239 195 *;
#X obj 133 141 f;
#X obj 1196 102 s \$0_g;
#N canvas 1997 828 390 335 linear_g 0;
#X obj 53 136 outlet;
#X obj 53 52 inlet index;
#X obj 53 80 t b;
#X obj 53 108 f 1;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 3 0 0 0;
#X restore 927 337 pd linear_g;
#N canvas 1511 730 568 339 tanh_g 0;
#X obj 53 52 inlet index;
#X obj 223 80 t b s;
#X obj 191 163 array get;
#X msg 225 130 1;
#X obj 191 219 outlet;
#X obj 223 52 inlet s_a;
#X obj 191 191 expr 1 - pow($f1 \, 2);
#X connect 0 0 2 0;
#X connect 1 0 3 0;
#X connect 1 1 2 2;
#X connect 2 0 6 0;
#X connect 3 0 2 1;
#X connect 5 0 1 0;
#X connect 6 0 4 0;
#X restore 583 332 pd tanh_g;
#N canvas 2009 936 513 355 relu_g 0;
#X obj 53 52 inlet index;
#X obj 388 52 inlet leak;
#X obj 223 52 inlet s_z;
#X obj 223 80 t b s;
#X obj 191 163 array get;
#X msg 225 130 1;
#X obj 191 215 expr if($f1 >= 0 \, 1 \, $f2);
#X obj 191 243 outlet;
#X connect 0 0 4 0;
#X connect 1 0 6 1;
#X connect 2 0 3 0;
#X connect 3 0 5 0;
#X connect 3 1 4 2;
#X connect 4 0 6 0;
#X connect 5 0 4 1;
#X connect 6 0 7 0;
#X restore 411 399 pd relu_g;
#N canvas 1503 658 568 339 sigmoid_g 0;
#X obj 53 52 inlet index;
#X obj 223 80 t b s;
#X obj 191 163 array get;
#X msg 225 130 1;
#X obj 192 219 outlet;
#X obj 223 52 inlet s_a;
#X obj 192 190 expr $f1 * (1 - $f1);
#X connect 0 0 2 0;
#X connect 1 0 3 0;
#X connect 1 1 2 2;
#X connect 2 0 6 0;
#X connect 3 0 2 1;
#X connect 5 0 1 0;
#X connect 6 0 4 0;
#X restore 755 332 pd sigmoid_g;
#N canvas 1507 694 526 268 use_relu 0;
#X obj 148 89 r \$0_g;
#X obj 127 122 f;
#X obj 127 150 == 1;
#X obj 66 178 spigot 0;
#X obj 66 56 t f b;
#X obj 66 206 outlet;
#X obj 66 28 inlet;
#X text 177 148 // ReLU activation;
#X connect 0 0 1 1;
#X connect 1 0 2 0;
#X connect 2 0 3 1;
#X connect 3 0 5 0;
#X connect 4 0 3 0;
#X connect 4 1 1 0;
#X connect 6 0 4 0;
#X restore 411 299 pd use_relu;
#N canvas 1511 730 526 268 use_tanh 0;
#X obj 148 89 r \$0_g;
#X obj 127 122 f;
#X obj 66 178 spigot 0;
#X obj 66 56 t f b;
#X obj 66 206 outlet;
#X obj 66 28 inlet;
#X obj 127 150 == 2;
#X text 177 148 // tanh activation;
#X connect 0 0 1 1;
#X connect 1 0 6 0;
#X connect 2 0 4 0;
#X connect 3 0 2 0;
#X connect 3 1 1 0;
#X connect 5 0 3 0;
#X connect 6 0 2 1;
#X restore 583 299 pd use_tanh;
#N canvas 1511 730 526 268 use_sigmoid 0;
#X obj 148 89 r \$0_g;
#X obj 127 122 f;
#X obj 66 178 spigot 0;
#X obj 66 56 t f b;
#X obj 66 206 outlet;
#X obj 66 28 inlet;
#X obj 127 150 == 3;
#X text 183 148 // sigmoid activation;
#X connect 0 0 1 1;
#X connect 1 0 6 0;
#X connect 2 0 4 0;
#X connect 3 0 2 0;
#X connect 3 1 1 0;
#X connect 5 0 3 0;
#X connect 6 0 2 1;
#X restore 755 299 pd use_sigmoid;
#N canvas 1511 730 526 268 use_linear 0;
#X obj 148 89 r \$0_g;
#X obj 127 122 f;
#X obj 66 178 spigot 0;
#X obj 66 56 t f b;
#X obj 66 206 outlet;
#X obj 66 28 inlet;
#X obj 127 150 == 4;
#X text 193 149 // linear activation;
#X connect 0 0 1 1;
#X connect 1 0 6 0;
#X connect 2 0 4 0;
#X connect 3 0 2 0;
#X connect 3 1 1 0;
#X connect 5 0 3 0;
#X connect 6 0 2 1;
#X restore 927 299 pd use_linear;
#X text 1397 57 // awkward but \, activation numbers \; 1: leaky ReLU \; 2: tanh \; 3: sigmoid \; 4: linear \;;
#X obj 991 102 s \$0_leak;
#X obj 501 333 r \$0_leak;
#X obj 480 366 f;
#X obj 411 327 t f b;
#X obj 652 100 t s s, f 9;
#X obj 239 266 t f f f f f f, f 108;
#X obj 1100 299 s \$0_dz_index;
#X obj 571 684 r \$0_dz_index;
#X connect 0 0 7 0;
#X connect 1 0 20 0;
#X connect 3 0 5 0;
#X connect 5 0 4 0;
#X connect 6 0 3 1;
#X connect 7 0 2 0;
#X connect 7 1 19 0;
#X connect 8 0 30 0;
#X connect 9 0 23 1;
#X connect 10 0 34 0;
#X connect 11 0 4 2;
#X connect 12 0 18 1;
#X connect 14 0 6 0;
#X connect 14 1 3 2;
#X connect 15 0 14 0;
#X connect 16 0 35 0;
#X connect 17 0 19 1;
#X connect 18 0 16 0;
#X connect 19 0 18 0;
#X connect 21 0 5 1;
#X connect 22 0 5 1;
#X connect 23 0 5 1;
#X connect 24 0 5 1;
#X connect 25 0 33 0;
#X connect 26 0 22 0;
#X connect 27 0 24 0;
#X connect 28 0 21 0;
#X connect 31 0 32 1;
#X connect 32 0 23 2;
#X connect 33 0 23 0;
#X connect 33 1 32 0;
#X connect 34 0 22 1;
#X connect 34 1 24 1;
#X connect 35 0 3 0;
#X connect 35 1 25 0;
#X connect 35 2 26 0;
#X connect 35 3 27 0;
#X connect 35 4 28 0;
#X connect 35 5 36 0;
#X connect 37 0 4 1;
